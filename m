Return-Path: <linux-rockchip-bounces+lists+linux-rockchip=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-rockchip@lfdr.de
Delivered-To: lists+linux-rockchip@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 98F5417DE8C
	for <lists+linux-rockchip@lfdr.de>; Mon,  9 Mar 2020 12:17:15 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:MIME-Version:References:In-Reply-To:
	Message-ID:Subject:To:From:Date:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=N+lrECAg74mqJSGZDEi19R/k1/0oZVIFAdYO5uuCVwY=; b=QHVEi4ZIauyXU7
	aEif/Sw+bEb5wyie91H5CJDyjSoGJL4fqUGfzg0zpOuAhAYLZCBXojQw363GCZ9mdqcVXIqD7fgtw
	zymyLxHEeqxzjqbsgvGASUg3zjlR6nMuRw3YLj1c834zKKKARalVTWckILtr9uohHrPTLZxA0pGmf
	hedYelcVpVgOiwsFsr7Ry8Nr4v8aQ6VEqW9OtCmwObvngLbUIIAV/3CcjVa1dePnkXGo5bXZncsPl
	SBeBC6/j4WJzJkUOTgCFY7/CR8T8PduC8SLkD+Q9eya7bEmSkqYQbfXA9GVMMqjCLnOKGLIOonkf7
	D+esqFtegFYjUqdt/afw==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1jBGPH-0000Ez-2C; Mon, 09 Mar 2020 11:17:11 +0000
Received: from relay8-d.mail.gandi.net ([217.70.183.201])
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1jBGP0-0008VE-Fs; Mon, 09 Mar 2020 11:16:58 +0000
X-Originating-IP: 90.89.41.158
Received: from xps13 (lfbn-tou-1-1473-158.w90-89.abo.wanadoo.fr [90.89.41.158])
 (Authenticated sender: miquel.raynal@bootlin.com)
 by relay8-d.mail.gandi.net (Postfix) with ESMTPSA id 69D341BF211;
 Mon,  9 Mar 2020 11:16:47 +0000 (UTC)
Date: Mon, 9 Mar 2020 12:16:45 +0100
From: Miquel Raynal <miquel.raynal@bootlin.com>
To: Yifeng Zhao <yifeng.zhao@rock-chips.com>
Subject: Re: [PATCH v3 1/3] mtd: rawnand: rockchip: NFC drivers for RK3308,
 RK3188 and others
Message-ID: <20200309121645.1fca069d@xps13>
In-Reply-To: <20200303094736.7490-2-yifeng.zhao@rock-chips.com>
References: <20200303094736.7490-1-yifeng.zhao@rock-chips.com>
 <20200303094736.7490-2-yifeng.zhao@rock-chips.com>
Organization: Bootlin
X-Mailer: Claws Mail 3.17.4 (GTK+ 2.24.32; x86_64-pc-linux-gnu)
MIME-Version: 1.0
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20200309_041654_816878_0BF9BCEA 
X-CRM114-Status: GOOD (  26.45  )
X-Spam-Score: -0.7 (/)
X-Spam-Report: SpamAssassin version 3.4.3 on bombadil.infradead.org summary:
 Content analysis details:   (-0.7 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.7 RCVD_IN_DNSWL_LOW      RBL: Sender listed at https://www.dnswl.org/,
 low trust [217.70.183.201 listed in list.dnswl.org]
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
X-BeenThere: linux-rockchip@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Upstream kernel work for Rockchip platforms
 <linux-rockchip.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-rockchip>, 
 <mailto:linux-rockchip-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-rockchip/>
List-Post: <mailto:linux-rockchip@lists.infradead.org>
List-Help: <mailto:linux-rockchip-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-rockchip>, 
 <mailto:linux-rockchip-request@lists.infradead.org?subject=subscribe>
Cc: devicetree@vger.kernel.org, vigneshr@ti.com, richard@nod.at,
 linux-rockchip@lists.infradead.org, robh+dt@kernel.org,
 linux-mtd@lists.infradead.org, heiko@sntech.de
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "Linux-rockchip" <linux-rockchip-bounces@lists.infradead.org>
Errors-To: linux-rockchip-bounces+lists+linux-rockchip=lfdr.de@lists.infradead.org

SGkgWWlmZW5nLAoKWWlmZW5nIFpoYW8gPHlpZmVuZy56aGFvQHJvY2stY2hpcHMuY29tPiB3cm90
ZSBvbiBUdWUsICAzIE1hciAyMDIwCjE3OjQ3OjM0ICswODAwOgoKPiBUaGlzIGRyaXZlciBzdXBw
b3J0cyBSb2NrY2hpcCBORkMgKE5BTkQgRmxhc2ggQ29udHJvbGxlcikgZm91bmQgb24gUkszMzA4
LAo+IFJLMzM2OCwgUktQWDMwLCBSVjExMDggYW5kIG90aGVyIFNPQ3MuIFRoZSBkcml2ZXIgaGFz
IGJlZW4gdGVzdGVkIHVzaW5nCj4gOC1iaXQgTkFORCBpbnRlcmZhY2Ugb24gdGhlIEFSTSBiYXNl
ZCBSSzMzMDggcGxhdGZvcm0uCj4gCj4gU3VwcG9ydCBSb2NrY2hpcCBORkMgdmVyc2lvbnM6Cj4g
LSBWNjogRUNDIDE2LCAyNCwgNDAgYW5kIDYwIGJpdHMgcGVyIDFLQiBkYXRhLiBGb3VuZCBvbiBS
SzMwNjYsIFJLMzM2OCwKPiAgICAgICBSSzMyMjksIFJLMzE4OCwgUkszMjg4LCBSSzMxMjgsIFJL
UFgzU0UsIFJLUHgzLCBSS1BYNSwgUkszMDM2IGFuZAo+ICAgICAgIFJLMzEyNi4KPiAtIFY4OiBF
Q0MgMTYgYml0cyBwZXIgMUtCIGRhdGEuIEZvdW5kIG9uIFJWMTEwOC83LCBSSzMzMDguCj4gLSBW
OTogRUNDIDE2LCA0MCwgNjAgYW5kIDcwIGJpdHMgcGVyIDFLQiBkYXRhLiBGb3VuZCBvbiBSSzMz
MjYsIFJLUFgzMC4KPiAKPiBTdXBwb3J0IGZlYXR1cmU6Cj4gLSBSZWFkIGZ1bGwgcGFnZSBkYXRh
IGJ5IERNQS4KPiAtIFN1cHBvcnQgSFcgRUNDKG9uZSBzdGVwIGlzIDFLQikuCj4gLSBTdXBwb3J0
IDIgLSAzMksgcGFnZSBzaXplLgo+IC0gU3VwcG9ydCA0IENTKGRlcGVuZCBvbiBTb2MpCj4gCj4g
TGltaXRhdGlvbnM6Cj4gLSBVbnN1cHBvcnQgNTEyQiBlY2Mgc3RlcC4KPiAtIFJhdyBwYWdlIHJl
YWQgYW5kIHdyaXRlIHdpdGhvdXQgZWNjIHJlZHVuZGFuY3kgY29kZS4gU28gY291bGQgbm90IHN1
cHBvcnQKPiAgIHJhdyBkYXRhIGR1bXAgYW5kIHJlc3RvcmUuCj4gLSBVbnRlc3RlZCBvbiBzb21l
IFNPQ3MuCj4gLSBVbnN1cHBvcnQgc3VicGFnZS4KPiAtIFVuc3VwcG9ydCByYW5kb21pemVyLgo+
IC0gVGhlIG9yaWdpbmFsIGJhZCBibG9jayBtYXNrIGlzIG5vdCBzdXBwb3J0ZWQuIEl0IGlzIHJl
Y29tbWVuZGVkIHRvIHVzZQo+ICAgdGhlIEJCVChiYWQgYmxvY2sgdGFibGUpLgo+IAo+IFNpZ25l
ZC1vZmYtYnk6IFlpZmVuZyBaaGFvIDx5aWZlbmcuemhhb0Byb2NrLWNoaXBzLmNvbT4KPiAtLS0K
PiAKPiBDaGFuZ2VzIGluIHYzOiBOb25lCj4gQ2hhbmdlcyBpbiB2MjoKPiAtIEZpeCBjb21waWxl
IGVycm9yLgo+IC0gSW5jbHVkZSBoZWFkZXIgZmlsZXMgc29ydGVkIGJ5IGZpbGUgbmFtZQo+IAo+
ICBkcml2ZXJzL210ZC9uYW5kL3Jhdy9LY29uZmlnICAgICAgICAgfCAgICA3ICsKPiAgZHJpdmVy
cy9tdGQvbmFuZC9yYXcvTWFrZWZpbGUgICAgICAgIHwgICAgMSArCj4gIGRyaXZlcnMvbXRkL25h
bmQvcmF3L3JvY2tjaGlwX25hbmQuYyB8IDEyMjkgKysrKysrKysrKysrKysrKysrKysrKysrKysK
PiAgMyBmaWxlcyBjaGFuZ2VkLCAxMjM3IGluc2VydGlvbnMoKykKPiAgY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvbXRkL25hbmQvcmF3L3JvY2tjaGlwX25hbmQuYwo+IAo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL210ZC9uYW5kL3Jhdy9LY29uZmlnIGIvZHJpdmVycy9tdGQvbmFuZC9yYXcvS2Nv
bmZpZwo+IGluZGV4IGE4MGE0NmJiNWI4Yi4uODMxM2IxMmE5ZDg1IDEwMDY0NAo+IC0tLSBhL2Ry
aXZlcnMvbXRkL25hbmQvcmF3L0tjb25maWcKPiArKysgYi9kcml2ZXJzL210ZC9uYW5kL3Jhdy9L
Y29uZmlnCj4gQEAgLTQzMyw2ICs0MzMsMTMgQEAgY29uZmlnIE1URF9OQU5EX01FU09OCj4gIAkg
IEVuYWJsZXMgc3VwcG9ydCBmb3IgTkFORCBjb250cm9sbGVyIG9uIEFtbG9naWMncyBNZXNvbiBT
b0NzLgo+ICAJICBUaGlzIGNvbnRyb2xsZXIgaXMgZm91bmQgb24gTWVzb24gU29Dcy4KPiAgCj4g
K2NvbmZpZyBNVERfTkFORF9ST0NLQ0hJUAo+ICsJdHJpc3RhdGUgIlJvY2tjaGlwIE5BTkQgY29u
dHJvbGxlciIKPiArCWRlcGVuZHMgb24gQVJDSF9ST0NLQ0hJUCB8fCBDT01QSUxFX1RFU1QKPiAr
CWRlcGVuZHMgb24gSEFTX0lPTUVNCj4gKwloZWxwCj4gKwkgIEVuYWJsZXMgc3VwcG9ydCBmb3Ig
TkFORCBjb250cm9sbGVyIG9uIFJvY2tjaGlwIFNvQ3MuCj4gKwo+ICBjb25maWcgTVREX05BTkRf
R1BJTwo+ICAJdHJpc3RhdGUgIkdQSU8gYXNzaXN0ZWQgTkFORCBjb250cm9sbGVyIgo+ICAJZGVw
ZW5kcyBvbiBHUElPTElCIHx8IENPTVBJTEVfVEVTVAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL210
ZC9uYW5kL3Jhdy9NYWtlZmlsZSBiL2RyaXZlcnMvbXRkL25hbmQvcmF3L01ha2VmaWxlCj4gaW5k
ZXggMmQxMzZiMTU4ZmI3Li44YmFmYTU5Yjg5NDAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9tdGQv
bmFuZC9yYXcvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL210ZC9uYW5kL3Jhdy9NYWtlZmlsZQo+
IEBAIC01OCw2ICs1OCw3IEBAIG9iai0kKENPTkZJR19NVERfTkFORF9URUdSQSkJCSs9IHRlZ3Jh
X25hbmQubwo+ICBvYmotJChDT05GSUdfTVREX05BTkRfU1RNMzJfRk1DMikJKz0gc3RtMzJfZm1j
Ml9uYW5kLm8KPiAgb2JqLSQoQ09ORklHX01URF9OQU5EX01FU09OKQkJKz0gbWVzb25fbmFuZC5v
Cj4gIG9iai0kKENPTkZJR19NVERfTkFORF9DQURFTkNFKQkJKz0gY2FkZW5jZS1uYW5kLWNvbnRy
b2xsZXIubwo+ICtvYmotJChDT05GSUdfTVREX05BTkRfUk9DS0NISVApCQkrPSByb2NrY2hpcF9u
YW5kLm8KPiAgCj4gIG5hbmQtb2JqcyA6PSBuYW5kX2Jhc2UubyBuYW5kX2xlZ2FjeS5vIG5hbmRf
YmJ0Lm8gbmFuZF90aW1pbmdzLm8gbmFuZF9pZHMubwo+ICBuYW5kLW9ianMgKz0gbmFuZF9vbmZp
Lm8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9tdGQvbmFuZC9yYXcvcm9ja2NoaXBfbmFuZC5jIGIv
ZHJpdmVycy9tdGQvbmFuZC9yYXcvcm9ja2NoaXBfbmFuZC5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2
NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLmVmZWRhNjA5ZmJmMgo+IC0tLSAvZGV2L251bGwKPiAr
KysgYi9kcml2ZXJzL210ZC9uYW5kL3Jhdy9yb2NrY2hpcF9uYW5kLmMKPiBAQCAtMCwwICsxLDEy
MjkgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgT1IgTUlUCj4gKy8q
Cj4gKyAqIFJvY2tjaGlwIE5BTkQgRmxhc2ggY29udHJvbGxlciBkcml2ZXIuCj4gKyAqIENvcHly
aWdodCAoQykgMjAyMCBSb2NrY2hpcCBJbmMuCj4gKyAqIEF1dGhvcnM6IFlpZmVuZyBaaGFvIDx5
aWZlbmcuemhhb0Byb2NrLWNoaXBzLmNvbT4KPiArICovCj4gKwo+ICsjaW5jbHVkZSA8bGludXgv
Y2xrLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgo+ICsjaW5jbHVkZSA8bGludXgvZG1h
LW1hcHBpbmcuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2RtYWVuZ2luZS5oPgo+ICsjaW5jbHVkZSA8
bGludXgvaW50ZXJydXB0Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9pb3BvbGwuaD4KPiArI2luY2x1
ZGUgPGxpbnV4L210ZC9yYXduYW5kLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9tdGQvbXRkLmg+Cj4g
KyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiArI2luY2x1ZGUgPGxpbnV4L29mLmg+Cj4gKyNp
bmNsdWRlIDxsaW51eC9vZl9kZXZpY2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2Rl
dmljZS5oPgo+ICsKPiArLyoKPiArICogTkZDIFBhZ2UgRGF0YSBMYXlvdXQ6Cj4gKyAqCTEwMjQg
Qnl0ZXMgRGF0YSArIDRCeXRlcyBzeXMgZGF0YSArIDI4Qnl0ZXN+MTI0Qnl0ZXMgZWNjICsKPiAr
ICoJMTAyNCBCeXRlcyBEYXRhICsgNEJ5dGVzIHN5cyBkYXRhICsgMjhCeXRlc34xMjRCeXRlcyBl
Y2MgKwo+ICsgKgkuLi4uLi4KPiArICogTkFORCBQYWdlIERhdGEgTGF5b3V0Ogo+ICsgKgkxMDI0
ICogbiBEYXRhICsgbSBCeXRlcyBvb2IKPiArICogT3JpZ2luYWwgQmFkIEJsb2NrIE1hc2sgTG9j
YXRpb246Cj4gKyAqCWZpcnN0IGJ5dGUgb2Ygb29iKHNwYXJlKQo+ICsgKiBuYW5kX2NoaXAtPm9v
Yl9wb2kgZGF0YSBsYXlvdXQ6Cj4gKyAqCTRCeXRlcyBzeXMgZGF0YSArIC4uLi4gKyA0Qnl0ZXMg
c3lzIGRhdGEgKyBlY2MgZGF0YQo+ICsgKi8KPiArCj4gKy8qIE5BTkQgY29udHJvbGxlciByZWdp
c3RlciBkZWZpbml0aW9uICovCj4gKyNkZWZpbmUJTkZDX1ZFUlNJT05fOQkJMHg1NjM5MzAzMAo+
ICsjZGVmaW5lCU5GQ19SRUFECQkoMCkKPiArI2RlZmluZQlORkNfV1JJVEUJCSgxKQo+ICsjZGVm
aW5lCU5GQ19GTUNUTAkJKDB4MDApCj4gKyNkZWZpbmUJCUZNQ1RMX0NFX1NFTF9NCQkweEZGCj4g
KyNkZWZpbmUJCUZNQ1RMX0NFX1NFTCh4KQkJKDEgPDwgKHgpKQo+ICsjZGVmaW5lCQlGTUNUTF9X
UAkJQklUKDgpCj4gKyNkZWZpbmUJCUZNQ1RMX1JEWQkJQklUKDkpCj4gKyNkZWZpbmUJTkZDX0ZN
V0FJVAkJKDB4MDQpCj4gKyNkZWZpbmUJTkZDX0ZMQ1RMX1Y2CQkoMHgwOCkKPiArI2RlZmluZQlO
RkNfRkxDVExfVjkJCSgweDEwKQo+ICsjZGVmaW5lCQlGTENUTF9SU1QJCUJJVCgwKQo+ICsjZGVm
aW5lCQlGTENUTF9XUgkJKDEpCS8qIDA6IHJlYWQsIDE6IHdyaXRlICovCj4gKyNkZWZpbmUJCUZM
Q1RMX1hGRVJfU1QJCUJJVCgyKQo+ICsjZGVmaW5lCQlGTENUTF9YRkVSX0VOCQlCSVQoMykKPiAr
I2RlZmluZQkJRkxDVExfQUNPUlJFQ1QJCUJJVCgxMCkgLyogYXV0byBjb3JyZWN0IGVycm9yIGJp
dHMgKi8KPiArI2RlZmluZQkJRkxDVExfWEZFUl9SRUFEWQlCSVQoMjApCj4gKyNkZWZpbmUJCUZM
Q1RMX1hGRVJfU0VDVE9SCSgyMikKPiArI2RlZmluZQkJRkxDVExfVE9HX0ZJWAkJQklUKDI5KQo+
ICsjZGVmaW5lCU5GQ19CQ0hDVExfVjYJCSgweDBDKQo+ICsjZGVmaW5lCQlCQ0hDVExfQkFOS19N
CSg3IDw8IDUpCj4gKyNkZWZpbmUJCUJDSENUTF9CQU5LCSg1KQo+ICsjZGVmaW5lCU5GQ19CQ0hD
VExfVjkJCSgweDIwKQo+ICsjZGVmaW5lCU5GQ19ETUFfQ0ZHX1Y2CQkoMHgxMCkKPiArI2RlZmlu
ZQlORkNfRE1BX0NGR19WOQkJKDB4MzApCj4gKyNkZWZpbmUJCURNQV9TVAkJCUJJVCgwKQo+ICsj
ZGVmaW5lCQlETUFfV1IJCQkoMSkJLyogMDogd3JpdGUsIDE6IHJlYWQgKi8KPiArI2RlZmluZQkJ
RE1BX0VOCQkJQklUKDIpCj4gKyNkZWZpbmUJCURNQV9BSEJfU0laRQkJKDMpCS8qIDA6IDEsIDE6
IDIsIDI6IDQgKi8KPiArI2RlZmluZQkJRE1BX0JVUlNUX1NJWkUJCSg2KQkvKiAwOiAxLCAzOiA0
LCA1OiA4LCA3OiAxNiAqLwo+ICsjZGVmaW5lCQlETUFfSU5DX05VTQkJKDkpCS8qIDEgLSAxNiAq
Lwo+ICsjZGVmaW5lCU5GQ19ETUFfREFUQV9CVUZfVjYJKDB4MTQpCj4gKyNkZWZpbmUJTkZDX0RN
QV9EQVRBX0JVRl9WOQkoMHgzNCkKPiArI2RlZmluZQlORkNfRE1BX09PQl9CVUZfVjYJKDB4MTgp
Cj4gKyNkZWZpbmUJTkZDX0RNQV9PT0JfQlVGX1Y5CSgweDM4KQo+ICsjZGVmaW5lCU5GQ19ETUFf
U1RfVjYJCSgweDFDKQo+ICsjZGVmaW5lCU5GQ19ETUFfU1RfVjkJCSgweDNDKQo+ICsjZGVmaW5l
CU5GQ19CQ0hfU1RfVjYJCSgweDIwKQo+ICsjZGVmaW5lCU5GQ19CQ0hfU1RfVjkJCSgweDE1MCkK
PiArI2RlZmluZQkJQkNIX1NUX0VSUjBfVjYJQklUKDIpCj4gKyNkZWZpbmUJCUJDSF9TVF9FUlIx
X1Y2CUJJVCgxNSkKPiArI2RlZmluZQkJQkNIX1NUX0VSUjBfVjkJQklUKDIpCj4gKyNkZWZpbmUJ
CUJDSF9TVF9FUlIxX1Y5CUJJVCgxOCkKPiArI2RlZmluZQkJRUNDX0VSUl9DTlQwX1Y2KHgpICgo
KCgoeCkgJiAoMHgxRiA8PCAzKSkgPj4gMykgXAo+ICsJCQkJfCAoKCh4KSAmICgxIDw8IDI3KSkg
Pj4gMjIpKSAmIDB4M0YpCj4gKyNkZWZpbmUJCUVDQ19FUlJfQ05UMV9WNih4KSAoKCgoKHgpICYg
KDB4MUYgPDwgMTYpKSA+PiAxNikgXAo+ICsJCQkJfCAoKCh4KSAmICgxIDw8IDI5KSkgPj4gMjQp
KSAmIDB4M0YpCj4gKyNkZWZpbmUJCUVDQ19FUlJfQ05UMF9WOSh4KSAoKCh4KSAmICgweDdGIDw8
IDMpKSA+PiAzKQo+ICsjZGVmaW5lCQlFQ0NfRVJSX0NOVDFfVjkoeCkgKCgoeCkgJiAoMHg3RiA8
PCAxOSkpID4+IDE5KQo+ICsjZGVmaW5lCU5GQ19SQU5ETVpfVjYJCSgweDE1MCkKPiArI2RlZmlu
ZQlORkNfUkFORE1aX1Y5CQkoMHgyMDgpCj4gKyNkZWZpbmUJTkZDX1ZFUl9WNgkJKDB4MTYwKQo+
ICsjZGVmaW5lCU5GQ19WRVJfVjkJCSgweDgwKQo+ICsjZGVmaW5lCU5GQ19JTlRFTl9WNgkJKDB4
MTZDKQo+ICsjZGVmaW5lCU5GQ19JTlRFTl9WOQkJKDB4MTIwKQo+ICsjZGVmaW5lCU5GQ19JTlRD
TFJfVjYJCSgweDE3MCkKPiArI2RlZmluZQlORkNfSU5UQ0xSX1Y5CQkoMHgxMjQpCj4gKyNkZWZp
bmUJTkZDX0lOVFNUX1Y2CQkoMHgxNzQpCj4gKyNkZWZpbmUJTkZDX0lOVFNUX1Y5CQkoMHgxMjgp
Cj4gKyNkZWZpbmUJCUlOVF9ETUEJCQlCSVQoMCkKPiArI2RlZmluZQlORkNfT09CMF9WNgkJKDB4
MjAwKQo+ICsjZGVmaW5lCU5GQ19PT0IwX1Y5CQkoMHgyMDApCj4gKyNkZWZpbmUJTkZDX09PQjFf
VjYJCSgweDIzMCkKPiArI2RlZmluZQlORkNfT09CMV9WOQkJKDB4MjA0KQo+ICsjZGVmaW5lCU5G
Q19CQU5LCQkoMHg4MDApCj4gKyNkZWZpbmUJCUJBTktfREFUQQkJKDB4MDApCj4gKyNkZWZpbmUJ
CUJBTktfQUREUgkJKDB4MDQpCj4gKyNkZWZpbmUJCUJBTktfQ01ECQkoMHgwOCkKPiArI2RlZmlu
ZQlORkNfU1JBTTAJCSgweDEwMDApCj4gKyNkZWZpbmUJTkZDX1NSQU0xCQkoMHgxNDAwKQo+ICsK
PiArI2RlZmluZQlUSElTX05BTUUJCSJyay1uYW5kIgo+ICsKPiArI2RlZmluZQlSS19USU1FT1VU
CQkoNTAwMDAwKQo+ICsjZGVmaW5lCVJLX05BTkRfTUFYX05TRUxTCSg0KSAvKiBTb21lIFNvYyBv
bmx5IGhhcyAxIG9yIDIgQ1NzICovCj4gKyNkZWZpbmUJTkZDX1NZU19EQVRBX1NJWkUJKDQpIC8q
IDQgYnl0ZXMgc3lzIGRhdGEgaW4gb29iIHByZSAxMDI0IGRhdGEgKi8KPiArI2RlZmluZQlSS19E
RUZBVUxUX0NMT0NLX1JBVEUJKDE1MCAqIDEwMDAgKiAxMDAwKSAvKiAxNTAgTWh6Ki8KPiArI2Rl
ZmluZQlBQ0NUSU1JTkcoY3NydywgcndwdywgcndjcykgKChjc3J3KSA8PCAxMiB8IChyd3B3KSA8
PCA1IHwgKHJ3Y3MpKQo+ICsKPiArc3RydWN0IHJrX25mY19uYW5kX2NoaXAgewo+ICsJc3RydWN0
IGxpc3RfaGVhZCBub2RlOwo+ICsJc3RydWN0IG5hbmRfY2hpcCBuYW5kOwo+ICsKPiArCXUzMiBz
cGFyZV9wZXJfc2VjdG9yOwo+ICsJdTMyIG9vYl9idWZfcGVyX3NlY3RvcjsKPiArCj4gKwlpbnQg
bnNlbHM7Cj4gKwl1OCBzZWxzWzBdOwo+ICsJLyogbm90aGluZyBhZnRlciB0aGlzIGZpZWxkICov
Cj4gK307Cj4gKwo+ICtzdHJ1Y3QgcmtfbmZjX2NsayB7Cj4gKwlpbnQgbmZjX3JhdGU7Cj4gKwlz
dHJ1Y3QgY2xrICpuZmNfY2xrOwo+ICsJc3RydWN0IGNsayAqYWhiX2NsazsKPiArfTsKPiArCj4g
K3N0cnVjdCBya19uZmMgewo+ICsJc3RydWN0IG5hbmRfY29udHJvbGxlciBjb250cm9sbGVyOwo+
ICsJc3RydWN0IHJrX25mY19jbGsgY2xrOwo+ICsKPiArCXN0cnVjdCBkZXZpY2UgKmRldjsKPiAr
CXZvaWQgX19pb21lbSAqcmVnczsKPiArCWludAluZmNfdmVyc2lvbjsKPiArCWludAltYXhfZWNj
X3N0cmVuZ3RoOwo+ICsJaW50CXNlbGVjdGVkX2Jhbms7Cj4gKwlpbnQJYmFuZF9vZmZzZXQ7Cj4g
Kwo+ICsJc3RydWN0IGNvbXBsZXRpb24gZG9uZTsKPiArCXN0cnVjdCBsaXN0X2hlYWQgY2hpcHM7
Cj4gKwo+ICsJdTggKmJ1ZmZlcjsKPiArCXU4ICpwYWdlX2J1ZjsKPiArCXUzMiAqb29iX2J1ZjsK
PiArCj4gKwl1bnNpZ25lZCBsb25nIGFzc2lnbmVkX2NzOwo+ICt9Owo+ICsKPiArc3RhdGljIGlu
bGluZSBzdHJ1Y3QgcmtfbmZjX25hbmRfY2hpcCAqdG9fcmtfbmFuZChzdHJ1Y3QgbmFuZF9jaGlw
ICpuYW5kKQo+ICt7Cj4gKwlyZXR1cm4gY29udGFpbmVyX29mKG5hbmQsIHN0cnVjdCBya19uZmNf
bmFuZF9jaGlwLCBuYW5kKTsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSB1OCAqZGF0YV9wdHIo
c3RydWN0IG5hbmRfY2hpcCAqY2hpcCwgY29uc3QgdTggKnAsIGludCBpKQo+ICt7Cj4gKwlyZXR1
cm4gKHU4ICopcCArIGkgKiBjaGlwLT5lY2Muc2l6ZTsKPiArfQo+ICsKPiArc3RhdGljIGlubGlu
ZSB1OCAqb29iX3B0cihzdHJ1Y3QgbmFuZF9jaGlwICpjaGlwLCBpbnQgaSkKPiArewo+ICsJdTgg
KnBvaTsKPiArCj4gKwlwb2kgPSBjaGlwLT5vb2JfcG9pICsgaSAqIE5GQ19TWVNfREFUQV9TSVpF
Owo+ICsKPiArCXJldHVybiBwb2k7Cj4gK30KPiArCj4gK3N0YXRpYyBpbmxpbmUgaW50IHJrX2Rh
dGFfbGVuKHN0cnVjdCBuYW5kX2NoaXAgKmNoaXApCj4gK3sKPiArCXN0cnVjdCBya19uZmNfbmFu
ZF9jaGlwICpya19uYW5kID0gdG9fcmtfbmFuZChjaGlwKTsKPiArCj4gKwlyZXR1cm4gY2hpcC0+
ZWNjLnNpemUgKyBya19uYW5kLT5zcGFyZV9wZXJfc2VjdG9yOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
aW5saW5lIHU4ICpya19kYXRhX3B0cihzdHJ1Y3QgbmFuZF9jaGlwICpjaGlwLCAgaW50IGkpCj4g
K3sKPiArCXN0cnVjdCBya19uZmMgKm5mYyA9IG5hbmRfZ2V0X2NvbnRyb2xsZXJfZGF0YShjaGlw
KTsKPiArCj4gKwlyZXR1cm4gbmZjLT5idWZmZXIgKyBpICogcmtfZGF0YV9sZW4oY2hpcCk7Cj4g
K30KPiArCj4gK3N0YXRpYyBpbmxpbmUgdTggKnJrX29vYl9wdHIoc3RydWN0IG5hbmRfY2hpcCAq
Y2hpcCwgaW50IGkpCj4gK3sKPiArCXN0cnVjdCBya19uZmMgKm5mYyA9IG5hbmRfZ2V0X2NvbnRy
b2xsZXJfZGF0YShjaGlwKTsKPiArCj4gKwlyZXR1cm4gbmZjLT5idWZmZXIgKyBpICogcmtfZGF0
YV9sZW4oY2hpcCkgKyBjaGlwLT5lY2Muc2l6ZTsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSB2
b2lkIG5mY193cml0ZWwoc3RydWN0IHJrX25mYyAqbmZjLCB1MzIgdmFsLCB1MzIgcmVnKQo+ICt7
Cj4gKwl3cml0ZWwodmFsLCBuZmMtPnJlZ3MgKyByZWcpOwo+ICt9CgpJIGRvbid0IHRoaW5rIHRo
ZXNlIG5mY19yZWFkL3dyaXRle2wsdyxifSBhcmUgdXNlZnVsLi4uCgo+ICsKPiArc3RhdGljIGlu
bGluZSB2b2lkIG5mY193cml0ZXcoc3RydWN0IHJrX25mYyAqbmZjLCB1MTYgdmFsLCB1MzIgcmVn
KQo+ICt7Cj4gKwl3cml0ZXcodmFsLCBuZmMtPnJlZ3MgKyByZWcpOwo+ICt9Cj4gKwo+ICtzdGF0
aWMgaW5saW5lIHZvaWQgbmZjX3dyaXRlYihzdHJ1Y3QgcmtfbmZjICpuZmMsIHU4IHZhbCwgdTMy
IHJlZykKPiArewo+ICsJd3JpdGViKHZhbCwgbmZjLT5yZWdzICsgcmVnKTsKPiArfQo+ICsKPiAr
c3RhdGljIGlubGluZSB1MzIgbmZjX3JlYWRsKHN0cnVjdCBya19uZmMgKm5mYywgdTMyIHJlZykK
PiArewo+ICsJcmV0dXJuIHJlYWRsX3JlbGF4ZWQobmZjLT5yZWdzICsgcmVnKTsKPiArfQo+ICsK
PiArc3RhdGljIGlubGluZSB1MTYgbmZjX3JlYWR3KHN0cnVjdCBya19uZmMgKm5mYywgdTMyIHJl
ZykKPiArewo+ICsJcmV0dXJuIHJlYWR3X3JlbGF4ZWQobmZjLT5yZWdzICsgcmVnKTsKPiArfQo+
ICsKPiArc3RhdGljIGlubGluZSB1OCBuZmNfcmVhZGIoc3RydWN0IHJrX25mYyAqbmZjLCB1MzIg
cmVnKQo+ICt7Cj4gKwlyZXR1cm4gcmVhZGJfcmVsYXhlZChuZmMtPnJlZ3MgKyByZWcpOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgdm9pZCBya19uZmNfc2VsZWN0X2NoaXAoc3RydWN0IG5hbmRfY2hpcCAq
bmFuZCwgaW50IGNoaXApCj4gK3sKPiArCXN0cnVjdCBya19uZmMgKm5mYyA9IG5hbmRfZ2V0X2Nv
bnRyb2xsZXJfZGF0YShuYW5kKTsKPiArCXN0cnVjdCBya19uZmNfbmFuZF9jaGlwICpya19uYW5k
ID0gdG9fcmtfbmFuZChuYW5kKTsKPiArCXUzMiB2YWw7Cj4gKwo+ICsJaWYgKGNoaXAgPCAwKSB7
Cj4gKwkJbmZjLT5zZWxlY3RlZF9iYW5rID0gLTE7Cj4gKwkJcmV0dXJuOwo+ICsJfQo+ICsKPiAr
CW5mYy0+c2VsZWN0ZWRfYmFuayA9IHJrX25hbmQtPnNlbHNbY2hpcF07Cj4gKwluZmMtPmJhbmRf
b2Zmc2V0ID0gTkZDX0JBTksgKyBuZmMtPnNlbGVjdGVkX2JhbmsgKiAweDEwMDsKPiArCj4gKwl2
YWwgPSBuZmNfcmVhZGwobmZjLCBORkNfRk1DVEwpOwo+ICsJdmFsICY9IH5GTUNUTF9DRV9TRUxf
TTsKPiArCXZhbCB8PSBGTUNUTF9DRV9TRUwobmZjLT5zZWxlY3RlZF9iYW5rKTsKPiArCj4gKwlu
ZmNfd3JpdGVsKG5mYywgdmFsLCBORkNfRk1DVEwpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHJr
X25mY19kZXZfcmVhZHkoc3RydWN0IG5hbmRfY2hpcCAqbmFuZCkKPiArewo+ICsJc3RydWN0IHJr
X25mYyAqbmZjID0gbmFuZF9nZXRfY29udHJvbGxlcl9kYXRhKG5hbmQpOwo+ICsKPiArCWlmIChu
ZmNfcmVhZGwobmZjLCBORkNfRk1DVEwpICYgRk1DVExfUkRZKQo+ICsJCXJldHVybiAxOwo+ICsK
PiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBya19uZmNfY21kX2N0cmwoc3Ry
dWN0IG5hbmRfY2hpcCAqY2hpcCwgaW50IGRhdCwKPiArCQkJICAgICB1bnNpZ25lZCBpbnQgY3Ry
bCkKPiArewo+ICsJc3RydWN0IHJrX25mYyAqbmZjID0gbmFuZF9nZXRfY29udHJvbGxlcl9kYXRh
KGNoaXApOwo+ICsJaW50IHJlZ19vZmZzZXQgPSBuZmMtPmJhbmRfb2Zmc2V0Owo+ICsKPiArCWlm
IChjdHJsICYgTkFORF9BTEUpCj4gKwkJcmVnX29mZnNldCArPSBCQU5LX0FERFI7Cj4gKwllbHNl
IGlmIChjdHJsICYgTkFORF9DTEUpCj4gKwkJcmVnX29mZnNldCArPSBCQU5LX0NNRDsKPiArCj4g
KwlpZiAoZGF0ICE9IE5BTkRfQ01EX05PTkUpCj4gKwkJbmZjX3dyaXRlYihuZmMsIGRhdCAmIDB4
RkYsIHJlZ19vZmZzZXQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHZvaWQgcmtfbmZjX3dh
aXRfaW9yZWFkeShzdHJ1Y3QgcmtfbmZjICpuZmMpCj4gK3sKPiArCWludCByYzsKPiArCXUzMiB2
YWw7Cj4gKwo+ICsJcmMgPSByZWFkbF9wb2xsX3RpbWVvdXRfYXRvbWljKG5mYy0+cmVncyArIE5G
Q19GTUNUTCwgdmFsLAo+ICsJCQkJICAgICAgIHZhbCAmIEZNQ1RMX1JEWSwgMTAsIFJLX1RJTUVP
VVQpOwo+ICsJaWYgKHJjIDwgMCkKPiArCQlkZXZfZXJyKG5mYy0+ZGV2LCAiZGF0YSBub3QgcmVh
ZHlcbiIpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW5saW5lIHU4IHJrX25mY19yZWFkX2J5dGUoc3Ry
dWN0IG5hbmRfY2hpcCAqY2hpcCkKPiArewo+ICsJc3RydWN0IHJrX25mYyAqbmZjID0gbmFuZF9n
ZXRfY29udHJvbGxlcl9kYXRhKGNoaXApOwo+ICsKPiArCXJldHVybiBuZmNfcmVhZGIobmZjLCBu
ZmMtPmJhbmRfb2Zmc2V0ICsgQkFOS19EQVRBKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgcmtf
bmZjX3JlYWRfYnVmKHN0cnVjdCBuYW5kX2NoaXAgKmNoaXAsIHU4ICpidWYsIGludCBsZW4pCj4g
K3sKPiArCWludCBpOwo+ICsKPiArCWZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykKPiArCQlidWZb
aV0gPSBya19uZmNfcmVhZF9ieXRlKGNoaXApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBya19u
ZmNfd3JpdGVfYnl0ZShzdHJ1Y3QgbmFuZF9jaGlwICpjaGlwLCB1OCBieXRlKQo+ICt7Cj4gKwlz
dHJ1Y3QgcmtfbmZjICpuZmMgPSBuYW5kX2dldF9jb250cm9sbGVyX2RhdGEoY2hpcCk7Cj4gKwo+
ICsJbmZjX3dyaXRlYihuZmMsIGJ5dGUsIG5mYy0+YmFuZF9vZmZzZXQgKyBCQU5LX0RBVEEpOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBya19uZmNfd3JpdGVfYnVmKHN0cnVjdCBuYW5kX2NoaXAg
KmNoaXAsIGNvbnN0IHU4ICpidWYsIGludCBsZW4pCj4gK3sKPiArCWludCBpOwo+ICsKPiArCWZv
ciAoaSA9IDA7IGkgPCBsZW47IGkrKykKPiArCQlya19uZmNfd3JpdGVfYnl0ZShjaGlwLCBidWZb
aV0pOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHJrX25mY19zZXR1cF9kYXRhX2ludGVyZmFjZShz
dHJ1Y3QgbmFuZF9jaGlwICpjaGlwLCBpbnQgY3NsaW5lLAo+ICsJCQkJCWNvbnN0IHN0cnVjdCBu
YW5kX2RhdGFfaW50ZXJmYWNlICpjb25mKQo+ICt7Cj4gKwlzdHJ1Y3QgcmtfbmZjICpuZmMgPSBu
YW5kX2dldF9jb250cm9sbGVyX2RhdGEoY2hpcCk7Cj4gKwljb25zdCBzdHJ1Y3QgbmFuZF9zZHJf
dGltaW5ncyAqdGltaW5nczsKPiArCXUzMiByYXRlLCB0YzJydywgdHJ3cHcsIHRydzJjOwo+ICsJ
dTMyIHRlbXA7Cj4gKwo+ICsJaWYgKGNzbGluZSA9PSBOQU5EX0RBVEFfSUZBQ0VfQ0hFQ0tfT05M
WSkKPiArCQlyZXR1cm4gMDsKPiArCj4gKwkvKiBub3Qgb25maSBuYW5kIGZsYXNoICovCj4gKwlp
ZiAoIWNoaXAtPnBhcmFtZXRlcnMub25maSkKPiArCQlyZXR1cm4gMDsKPiArCj4gKwl0aW1pbmdz
ID0gbmFuZF9nZXRfc2RyX3RpbWluZ3MoY29uZik7Cj4gKwlpZiAoSVNfRVJSKHRpbWluZ3MpKQo+
ICsJCXJldHVybiAtRU5PVFNVUFA7Cj4gKwo+ICsJcmF0ZSA9IGNsa19nZXRfcmF0ZShuZmMtPmNs
ay5uZmNfY2xrKTsKPiArCj4gKwkvKiB0dXJuIGNsb2NrIHJhdGUgaW50byBLSFogKi8KPiArCXJh
dGUgLz0gMTAwMDsKPiArCj4gKwl0YzJydyA9IHRydzJjID0gMTsKCgl0YzJydyA9IDE7Cgl0cncy
YyA9IDE7Cgo+ICsKPiArCXRyd3B3ID0gbWF4KHRpbWluZ3MtPnRXQ19taW4sIHRpbWluZ3MtPnRS
Q19taW4pIC8gMTAwMDsKPiArCXRyd3B3ID0gRElWX1JPVU5EX1VQKHRyd3B3ICogcmF0ZSwgMTAw
MDAwMCk7Cj4gKwo+ICsJdGVtcCA9IHRpbWluZ3MtPnRSRUFfbWF4IC8gMTAwMDsKPiArCXRlbXAg
PSBESVZfUk9VTkRfVVAodGVtcCAqIHJhdGUsIDEwMDAwMDApOwo+ICsKPiArCWlmICh0cndwdyA8
IHRlbXApCj4gKwkJdHJ3cHcgPSB0ZW1wOwo+ICsKPiArCWlmICh0cndwdyA+IDYpIHsKCldoYXQg
aXMgNiA/IFdvdWxkIGRlc2VydmUgYSBkZWZpbmUgYW5kIGFuIGV4cGxhbmF0aW9uIQoKPiArCQl0
YzJydysrOwo+ICsJCXRydzJjKys7Cj4gKwkJdHJ3cHcgLT0gMjsKPiArCX0KPiArCj4gKwkvKgo+
ICsJICogQUNDT046IGFjY2VzcyB0aW1pbmcgY29udHJvbCByZWdpc3Rlcgo+ICsJICogLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo+ICsJICogMzE6MTg6IHJlc2VydmVkCj4g
KwkgKiAxNzoxMjogY3NydywgY2xvY2sgY3ljbGVzIGZyb20gdGhlIGZhbGxpbmcgZWRnZSBvZiBD
U24gdG8gdGhlCj4gKwkJIGZhbGxpbmcgZWRnZSBvZiBSRG4gb3IgV1JuCj4gKwkgKiAxMToxMTog
cmVzZXJ2ZWQKPiArCSAqIDEwOjA1OiByd3B3LCB0aGUgd2lkdGggb2YgUkRuIG9yIFdSbiBpbiBw
cm9jZXNzb3IgY2xvY2sgY3ljbGVzCj4gKwkgKiAwNDowMDogcndjcywgY2xvY2sgY3ljbGVzIGZy
b20gdGhlIHJpc2luZyBlZGdlIG9mIFJEbiBvciBXUm4gdG8gdGhlCj4gKwkJIHJpc2luZyBlZGdl
IG9mIENTbgo+ICsJICovCj4gKwl0ZW1wID0gQUNDVElNSU5HKHRjMnJ3LCB0cndwdywgdHJ3MmMp
Owo+ICsJbmZjX3dyaXRlbChuZmMsIHRlbXAsIE5GQ19GTVdBSVQpOwo+ICsKPiArCXJldHVybiAw
Owo+ICt9Cj4gKwoKQSBjb21tZW50IGhlcmUgZXhwbGFpbmluZyB3aGF0IHRoZSBuZXh0IGZ1bmN0
aW9uIGRvZXMgYW5kIHdoeSB3b3VsZCBiZQpuaWNlLgoKPiArc3RhdGljIHZvaWQgcmtfbmZjX2Zv
cm1hdF9wYWdlKHN0cnVjdCBtdGRfaW5mbyAqbXRkLCBjb25zdCB1OCAqYnVmKQo+ICt7Cj4gKwlz
dHJ1Y3QgbmFuZF9jaGlwICpjaGlwID0gbXRkX3RvX25hbmQobXRkKTsKPiArCXN0cnVjdCBya19u
ZmMgKm5mYyA9IG5hbmRfZ2V0X2NvbnRyb2xsZXJfZGF0YShjaGlwKTsKPiArCXUzMiBpOwo+ICsK
PiArCW1lbXNldChuZmMtPmJ1ZmZlciwgMHhmZiwgbXRkLT53cml0ZXNpemUgKyBtdGQtPm9vYnNp
emUpOwo+ICsJc3dhcChjaGlwLT5vb2JfcG9pWzBdLCBjaGlwLT5vb2JfcG9pWzddKTsKPiArCWZv
ciAoaSA9IDA7IGkgPCBjaGlwLT5lY2Muc3RlcHM7IGkrKykgewo+ICsJCWlmIChidWYpCj4gKwkJ
CW1lbWNweShya19kYXRhX3B0cihjaGlwLCBpKSwgZGF0YV9wdHIoY2hpcCwgYnVmLCBpKSwKPiAr
CQkJICAgICAgIGNoaXAtPmVjYy5zaXplKTsKPiArCj4gKwkJbWVtY3B5KHJrX29vYl9wdHIoY2hp
cCwgaSksIG9vYl9wdHIoY2hpcCwgaSksCj4gKwkJICAgICAgIE5GQ19TWVNfREFUQV9TSVpFKTsK
PiArCX0KPiArfQo+ICsKPiArc3RhdGljIHZvaWQgcmtfbmZjX3hmZXJfc3RhcnQoc3RydWN0IHJr
X25mYyAqbmZjLCB1OCBydywgdTggbl9LQiwKPiArCQkJCWRtYV9hZGRyX3QgZG1hX2RhdGEsIGRt
YV9hZGRyX3QgZG1hX29vYikKPiArewo+ICsJdTMyIGRtYV9yZWcsIGZsX3JlZywgYmNoX3JlZzsK
PiArCj4gKwlkbWFfcmVnID0gRE1BX1NUIHwgKCghcncpIDw8IERNQV9XUikgIHwgRE1BX0VOIHwg
KDIgPDwgRE1BX0FIQl9TSVpFKSB8Cj4gKwkgICAgICAoNyA8PCBETUFfQlVSU1RfU0laRSkgfCAo
MTYgPDwgRE1BX0lOQ19OVU0pOwo+ICsKPiArCWZsX3JlZyA9IChydyA8PCBGTENUTF9XUikgfCBG
TENUTF9YRkVSX0VOIHwgRkxDVExfQUNPUlJFQ1QgfAo+ICsJCSAobl9LQiA8PCBGTENUTF9YRkVS
X1NFQ1RPUikgfCBGTENUTF9UT0dfRklYOwo+ICsKPiArCWlmIChuZmMtPm5mY192ZXJzaW9uID09
IDYpIHsKCkkgd291bGQgcHJlZmVyIHVzaW5nIHN3aXRjaCBzdGF0ZW1lbnRzIGFueSB0aW1lIHlv
dSBjaGVjayB0aGUgdmVyc2lvbi4KVGhlIHZlcnNpb24gc2hvdWxkIGJlIGFuIGVudW0uCgpZb3Ug
Y2FuIGFsc28gZGVmaW5lIGEgcGxhdGZvcm0gZGF0YSBzdHJ1Y3R1cmUgZm9yIHRoZSByZWdpc3Rl
ciBvZmZzZXRzCnRoYXQgaGF2ZSB0aGUgc2FtZSBuYW1lLCBidXQgbm90IG5lY2Vzc2FyaWx5IHRo
ZSBzYW1lIG9mZnNldC4gVGhlbiB5b3UKY2FuIHJlZmVyZW5jZSB0aGUgcmlnaHQgdmFsdWUgZGly
ZWN0bHkuCmVnLgoKCXN0cnVjdCBya19uZmNfcGxhdF9kYXRhIHsKCQl1MzIgbmZjX2JjaGN0bF9v
ZmY7CgkJLi4uCgl9OwoKCXN0cnVjdCBya19uZmNfcGxhdF9kYXRhIHJrX25mY192Nl9wbGF0X2Rh
dGEgPSB7CgkJbmZjX2JjaGN0bF9vZmYgPSAuLi47CgkJLi4uCgl9OwoKCWJjaF9yZWcgPSByZWFk
bChwZGF0YS0+bmZjX2JjaGN0bF9vZmYpOwoKPiArCQliY2hfcmVnID0gbmZjX3JlYWRsKG5mYywg
TkZDX0JDSENUTF9WNik7Cj4gKwkJYmNoX3JlZyA9IChiY2hfcmVnICYgKH5CQ0hDVExfQkFOS19N
KSkgfAo+ICsJCQkgIChuZmMtPnNlbGVjdGVkX2JhbmsgPDwgQkNIQ1RMX0JBTkspOwo+ICsJCW5m
Y193cml0ZWwobmZjLCBiY2hfcmVnLCBORkNfQkNIQ1RMX1Y2KTsKPiArCj4gKwkJbmZjX3dyaXRl
bChuZmMsIGRtYV9yZWcsIE5GQ19ETUFfQ0ZHX1Y2KTsKPiArCQluZmNfd3JpdGVsKG5mYywgKHUz
MilkbWFfZGF0YSwgTkZDX0RNQV9EQVRBX0JVRl9WNik7Cj4gKwkJbmZjX3dyaXRlbChuZmMsICh1
MzIpZG1hX29vYiwgTkZDX0RNQV9PT0JfQlVGX1Y2KTsKPiArCQluZmNfd3JpdGVsKG5mYywgZmxf
cmVnLCBORkNfRkxDVExfVjYpOwo+ICsJCWZsX3JlZyB8PSBGTENUTF9YRkVSX1NUOwo+ICsJCW5m
Y193cml0ZWwobmZjLCBmbF9yZWcsIE5GQ19GTENUTF9WNik7Cj4gKwl9IGVsc2Ugewo+ICsJCW5m
Y193cml0ZWwobmZjLCBkbWFfcmVnLCBORkNfRE1BX0NGR19WOSk7Cj4gKwkJbmZjX3dyaXRlbChu
ZmMsICh1MzIpZG1hX2RhdGEsIE5GQ19ETUFfREFUQV9CVUZfVjkpOwo+ICsJCW5mY193cml0ZWwo
bmZjLCAodTMyKWRtYV9vb2IsIE5GQ19ETUFfT09CX0JVRl9WOSk7Cj4gKwkJbmZjX3dyaXRlbChu
ZmMsIGZsX3JlZywgTkZDX0ZMQ1RMX1Y5KTsKPiArCQlmbF9yZWcgfD0gRkxDVExfWEZFUl9TVDsK
PiArCQluZmNfd3JpdGVsKG5mYywgZmxfcmVnLCBORkNfRkxDVExfVjkpOwo+ICsJfQo+ICt9Cj4g
Kwo+ICtzdGF0aWMgaW50IHJrX25mY193YWl0X2Zvcl94ZmVyX2RvbmUoc3RydWN0IHJrX25mYyAq
bmZjKQo+ICt7Cj4gKwl1MzIgcmVnOwo+ICsJaW50IHJldCA9IDA7Cj4gKwl2b2lkIF9faW9tZW0g
KnB0cjsKPiArCj4gKwlpZiAobmZjLT5uZmNfdmVyc2lvbiA9PSA2KQo+ICsJCXB0ciA9IG5mYy0+
cmVncyArIE5GQ19GTENUTF9WNjsKPiArCWVsc2UKPiArCQlwdHIgPSBuZmMtPnJlZ3MgKyBORkNf
RkxDVExfVjk7Cj4gKwo+ICsJcmV0ID0gcmVhZGxfcG9sbF90aW1lb3V0X2F0b21pYyhwdHIsIHJl
ZywKPiArCQkJCQlyZWcgJiBGTENUTF9YRkVSX1JFQURZLAo+ICsJCQkJCTEwLCBSS19USU1FT1VU
KTsKPiArCWlmIChyZXQpCj4gKwkJZGV2X2VycihuZmMtPmRldiwgInRpbWVvdXQgcmVnPSV4XG4i
LCByZWcpOwo+ICsKPiArCXJldHVybiByZXQ7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgcmtfbmZj
X3dyaXRlX3BhZ2Uoc3RydWN0IG10ZF9pbmZvICptdGQsIHN0cnVjdCBuYW5kX2NoaXAgKmNoaXAs
Cj4gKwkJCSAgICAgIGNvbnN0IHU4ICpidWYsIGludCBwYWdlLCBpbnQgcmF3KQo+ICt7Cj4gKwlz
dHJ1Y3QgcmtfbmZjICpuZmMgPSBuYW5kX2dldF9jb250cm9sbGVyX2RhdGEoY2hpcCk7Cj4gKwlz
dHJ1Y3QgbmFuZF9lY2NfY3RybCAqZWNjID0gJmNoaXAtPmVjYzsKPiArCXU4ICpvb2I7Cj4gKwlk
bWFfYWRkcl90IGRtYV9kYXRhLCBkbWFfb29iOwo+ICsJaW50IG9vYl9zdGVwID0gKGVjYy0+Ynl0
ZXMgPiA2MCkgPyAxMjggOiA2NDsKPiArCWludCBwYWdlc19wZXJfYmxrID0gbXRkLT5lcmFzZXNp
emUgLyBtdGQtPndyaXRlc2l6ZTsKPiArCXUzMiByZWc7Cj4gKwlpbnQgcmV0ID0gMCwgaTsKPiAr
Cj4gKwluYW5kX3Byb2dfcGFnZV9iZWdpbl9vcChjaGlwLCBwYWdlLCAwLCBOVUxMLCAwKTsKPiAr
Cj4gKwlpZiAoIXJhdykgewo+ICsJCW1lbWNweShuZmMtPnBhZ2VfYnVmLCBidWYsIG10ZC0+d3Jp
dGVzaXplKTsKPiArCQltZW1zZXQobmZjLT5vb2JfYnVmLCAweGZmLCBvb2Jfc3RlcCAqIGVjYy0+
c3RlcHMpOwo+ICsJCS8qCj4gKwkJICogVGhlIGZpcnN0IDggYmxvY2tzIGlzIHN0b3JlZCBsb2Fk
ZXIsIHRoZSBmaXJzdAo+ICsJCSAqIDMyIGJpdHMgb2Ygb29iIG5lZWQgbGluayB0byBuZXh0IHBh
Z2UgYWRkcmVzcwo+ICsJCSAqIGluIHRoZSBzYW1lIGJsb2NrIGZvciBCb290cm9tLgo+ICsJCSAq
IFN3YXAgdGhlIGZpcnN0IG9vYiB3aXRoIHRoZSBzZXZlbnRoIG9vYiwKPiArCQkgKiBhbmQgYmFk
IGJsb2NrIG1hc2sgc2F2ZSBhdCBzZXZlbnRoIG9vYi4KPiArCQkgKi8KPiArCQlzd2FwKGNoaXAt
Pm9vYl9wb2lbMF0sIGNoaXAtPm9vYl9wb2lbN10pOwo+ICsJCWZvciAoaSA9IDA7IGkgPCBlY2Mt
PnN0ZXBzOyBpKyspIHsKPiArCQkJb29iID0gY2hpcC0+b29iX3BvaSArIGkgKiBORkNfU1lTX0RB
VEFfU0laRTsKPiArCQkJcmVnID0gKG9vYlsyXSA8PCAxNikgfCAob29iWzNdIDw8IDI0KTsKPiAr
CQkJaWYgKCFpICYmIHBhZ2UgPCBwYWdlc19wZXJfYmxrICogOCkKPiArCQkJCXJlZyB8PSAocGFn
ZSAmIChwYWdlc19wZXJfYmxrIC0gMSkpICogNDsKPiArCQkJZWxzZQo+ICsJCQkJcmVnIHw9IG9v
YlswXSB8IChvb2JbMV0gPDwgOCk7Cj4gKwo+ICsJCQlpZiAobmZjLT5uZmNfdmVyc2lvbiA9PSA2
KQo+ICsJCQkJbmZjLT5vb2JfYnVmW2kgKiBvb2Jfc3RlcCAvIDRdID0gcmVnOwo+ICsJCQllbHNl
Cj4gKwkJCQluZmMtPm9vYl9idWZbaV0gPSByZWc7Cj4gKwkJfQo+ICsKPiArCQlkbWFfZGF0YSA9
IGRtYV9tYXBfc2luZ2xlKG5mYy0+ZGV2LCAodm9pZCAqKW5mYy0+cGFnZV9idWYsCj4gKwkJCQkJ
ICBtdGQtPndyaXRlc2l6ZSwgRE1BX1RPX0RFVklDRSk7Cj4gKwkJZG1hX29vYiA9IGRtYV9tYXBf
c2luZ2xlKG5mYy0+ZGV2LCBuZmMtPm9vYl9idWYsCj4gKwkJCQkJIGVjYy0+c3RlcHMgKiBvb2Jf
c3RlcCwKPiArCQkJCQkgRE1BX1RPX0RFVklDRSk7Cj4gKwo+ICsJCWluaXRfY29tcGxldGlvbigm
bmZjLT5kb25lKTsKPiArCQlpZiAobmZjLT5uZmNfdmVyc2lvbiA9PSA2KQo+ICsJCQluZmNfd3Jp
dGVsKG5mYywgSU5UX0RNQSwgTkZDX0lOVEVOX1Y2KTsKPiArCQllbHNlCj4gKwkJCW5mY193cml0
ZWwobmZjLCBJTlRfRE1BLCBORkNfSU5URU5fVjkpOwo+ICsKPiArCQlya19uZmNfeGZlcl9zdGFy
dChuZmMsIE5GQ19XUklURSwgZWNjLT5zdGVwcywgZG1hX2RhdGEsCj4gKwkJCQkgIGRtYV9vb2Ip
Owo+ICsJCXJldCA9IHdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmbmZjLT5kb25lLAo+ICsJ
CQkJCQkgIG1zZWNzX3RvX2ppZmZpZXMoMTAwKSk7Cj4gKwkJaWYgKCFyZXQpCj4gKwkJCXJldCA9
IC1FVElNRURPVVQ7Cj4gKwkJcmV0ID0gcmtfbmZjX3dhaXRfZm9yX3hmZXJfZG9uZShuZmMpOwo+
ICsKPiArCQlkbWFfdW5tYXBfc2luZ2xlKG5mYy0+ZGV2LCBkbWFfZGF0YSwgbXRkLT53cml0ZXNp
emUsCj4gKwkJCQkgRE1BX1RPX0RFVklDRSk7Cj4gKwkJZG1hX3VubWFwX3NpbmdsZShuZmMtPmRl
diwgZG1hX29vYiwgZWNjLT5zdGVwcyAqIG9vYl9zdGVwLAo+ICsJCQkJIERNQV9UT19ERVZJQ0Up
Owo+ICsJfSBlbHNlIHsKPiArCQlya19uZmNfd3JpdGVfYnVmKGNoaXAsIGJ1ZiwgbXRkLT53cml0
ZXNpemUgKyArIG10ZC0+b29ic2l6ZSk7Cj4gKwl9Cj4gKwo+ICsJaWYgKHJldCkKPiArCQlyZXR1
cm4gcmV0Owo+ICsKPiArCXJldHVybiBuYW5kX3Byb2dfcGFnZV9lbmRfb3AoY2hpcCk7Cj4gK30K
PiArCj4gK3N0YXRpYyBpbnQgcmtfbmZjX3dyaXRlX3BhZ2VfcmF3KHN0cnVjdCBuYW5kX2NoaXAg
KmNoaXAsIGNvbnN0IHU4ICpidWYsCj4gKwkJCQkgIGludCBvb2Jfb24sIGludCBwYWdlKQo+ICt7
Cj4gKwlzdHJ1Y3QgbXRkX2luZm8gKm10ZCA9IG5hbmRfdG9fbXRkKGNoaXApOwo+ICsJc3RydWN0
IHJrX25mYyAqbmZjID0gbmFuZF9nZXRfY29udHJvbGxlcl9kYXRhKGNoaXApOwo+ICsKPiArCXJr
X25mY19mb3JtYXRfcGFnZShtdGQsIGJ1Zik7Cj4gKwlyZXR1cm4gcmtfbmZjX3dyaXRlX3BhZ2Uo
bXRkLCBjaGlwLCBuZmMtPmJ1ZmZlciwgcGFnZSwgMSk7CgpJIHRoaW5rIHlvdSBzaG91bGQgYXZv
aWQgY2FsbGluZyAtPndyaXRlX3BhZ2UuIFlvdSB3aWxsIGF2b2lkIGFuCmluZGVudGF0aW9uIGxl
dmVsIGluIHRoaXMgZnVuY3Rpb24gYW5kIGNsYXJpZnkgd2hhdCB3cml0ZV9wYWdlX3JhdyBkby4K
U2FtZSBmb3IgcmVhZCwgYW5kIHRoZSBfb29iIGFsdGVybmF0aXZlLiBBbHNvLCBJJ20gc3VyZSB3
cml0ZV9idWYgZG9lcwpub3QgbmVlZCB0byBiZSBleHBvcnRlZCBhbmQgeW91IGNhbiBqdXN0IG1v
dmUgdGhlIGFjdHVhbCBjb2RlIGluIHRoaXMKZnVuY3Rpb24uCgo+ICt9Cj4gKwo+ICtzdGF0aWMg
aW50IHJrX25mY193cml0ZV9vb2Jfc3RkKHN0cnVjdCBuYW5kX2NoaXAgKmNoaXAsIGludCBwYWdl
KQo+ICt7Cj4gKwlyZXR1cm4gcmtfbmZjX3dyaXRlX3BhZ2VfcmF3KGNoaXAsIE5VTEwsIDEsIHBh
Z2UpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHJrX25mY19yZWFkX3BhZ2Uoc3RydWN0IG10ZF9p
bmZvICptdGQsIHN0cnVjdCBuYW5kX2NoaXAgKmNoaXAsCj4gKwkJCQl1MzIgZGF0YV9vZmZzLCB1
MzIgcmVhZGxlbiwKPiArCQkJCXU4ICpidWYsIGludCBwYWdlLCBpbnQgcmF3KQo+ICt7Cj4gKwlz
dHJ1Y3QgcmtfbmZjICpuZmMgPSBuYW5kX2dldF9jb250cm9sbGVyX2RhdGEoY2hpcCk7Cj4gKwlz
dHJ1Y3QgbmFuZF9lY2NfY3RybCAqZWNjID0gJmNoaXAtPmVjYzsKPiArCWRtYV9hZGRyX3QgZG1h
X2RhdGEsIGRtYV9vb2I7Cj4gKwlpbnQgb29iX3N0ZXAgPSAoZWNjLT5ieXRlcyA+IDYwKSA/IDEy
OCA6IDY0Owo+ICsJaW50IGJpdGZsaXBzID0gMDsKPiArCWludCByZXQsIGksIGJjaF9zdDsKPiAr
CXU4ICpvb2I7Cj4gKwl1MzIgdG1wOwo+ICsKPiArCW5hbmRfcmVhZF9wYWdlX29wKGNoaXAsIHBh
Z2UsIDAsIE5VTEwsIDApOwo+ICsJaWYgKCFyYXcpIHsKPiArCQlkbWFfZGF0YSA9IGRtYV9tYXBf
c2luZ2xlKG5mYy0+ZGV2LCBuZmMtPnBhZ2VfYnVmLAo+ICsJCQkJCSAgbXRkLT53cml0ZXNpemUs
Cj4gKwkJCQkJICBETUFfRlJPTV9ERVZJQ0UpOwo+ICsJCWRtYV9vb2IgPSBkbWFfbWFwX3Npbmds
ZShuZmMtPmRldiwgbmZjLT5vb2JfYnVmLAo+ICsJCQkJCSBlY2MtPnN0ZXBzICogb29iX3N0ZXAs
Cj4gKwkJCQkJIERNQV9GUk9NX0RFVklDRSk7Cj4gKwkJaW5pdF9jb21wbGV0aW9uKCZuZmMtPmRv
bmUpOwo+ICsJCWlmIChuZmMtPm5mY192ZXJzaW9uID09IDYpCj4gKwkJCW5mY193cml0ZWwobmZj
LCBJTlRfRE1BLCBORkNfSU5URU5fVjYpOwo+ICsJCWVsc2UKPiArCQkJbmZjX3dyaXRlbChuZmMs
IElOVF9ETUEsIE5GQ19JTlRFTl9WOSk7Cj4gKwkJcmtfbmZjX3hmZXJfc3RhcnQobmZjLCBORkNf
UkVBRCwgZWNjLT5zdGVwcywgZG1hX2RhdGEsCj4gKwkJCQkgIGRtYV9vb2IpOwo+ICsJCXJldCA9
IHdhaXRfZm9yX2NvbXBsZXRpb25fdGltZW91dCgmbmZjLT5kb25lLAo+ICsJCQkJCQkgIG1zZWNz
X3RvX2ppZmZpZXMoMTAwKSk7Cj4gKwkJaWYgKCFyZXQpCj4gKwkJCWRldl93YXJuKG5mYy0+ZGV2
LCAicmVhZCBhaGIvZG1hIGRvbmUgdGltZW91dFxuIik7Cj4gKwkJcmtfbmZjX3dhaXRfZm9yX3hm
ZXJfZG9uZShuZmMpOwo+ICsJCWRtYV91bm1hcF9zaW5nbGUobmZjLT5kZXYsIGRtYV9kYXRhLCBt
dGQtPndyaXRlc2l6ZSwKPiArCQkJCSBETUFfRlJPTV9ERVZJQ0UpOwo+ICsJCWRtYV91bm1hcF9z
aW5nbGUobmZjLT5kZXYsIGRtYV9vb2IsIGVjYy0+c3RlcHMgKiBvb2Jfc3RlcCwKPiArCQkJCSBE
TUFfRlJPTV9ERVZJQ0UpOwo+ICsKPiArCQlmb3IgKGkgPSAwOyBpIDwgZWNjLT5zdGVwczsgaSsr
KSB7Cj4gKwkJCW9vYiA9IGNoaXAtPm9vYl9wb2kgKyBpICogTkZDX1NZU19EQVRBX1NJWkU7Cj4g
KwkJCWlmIChuZmMtPm5mY192ZXJzaW9uID09IDYpCj4gKwkJCQl0bXAgPSBuZmMtPm9vYl9idWZb
aSAqIG9vYl9zdGVwIC8gNF07Cj4gKwkJCWVsc2UKPiArCQkJCXRtcCA9IG5mYy0+b29iX2J1Zltp
XTsKPiArCQkJKm9vYisrID0gKHU4KXRtcDsKPiArCQkJKm9vYisrID0gKHU4KSh0bXAgPj4gOCk7
Cj4gKwkJCSpvb2IrKyA9ICh1OCkodG1wID4+IDE2KTsKPiArCQkJKm9vYisrID0gKHU4KSh0bXAg
Pj4gMjQpOwo+ICsJCX0KPiArCQlzd2FwKGNoaXAtPm9vYl9wb2lbMF0sIGNoaXAtPm9vYl9wb2lb
N10pOwo+ICsJCWlmIChuZmMtPm5mY192ZXJzaW9uID09IDYpIHsKPiArCQkJZm9yIChpID0gMDsg
aSA8IGVjYy0+c3RlcHMgLyAyOyBpKyspIHsKPiArCQkJCWJjaF9zdCA9IG5mY19yZWFkbChuZmMs
IE5GQ19CQ0hfU1RfVjYgKyBpICogNCk7Cj4gKwkJCQlpZiAoYmNoX3N0ICYgQkNIX1NUX0VSUjBf
VjYgfHwKPiArCQkJCSAgICBiY2hfc3QgJiBCQ0hfU1RfRVJSMV9WNikgewo+ICsJCQkJCW10ZC0+
ZWNjX3N0YXRzLmZhaWxlZCsrOwo+ICsJCQkJCWJpdGZsaXBzID0gLTE7Cj4gKwkJCQl9IGVsc2Ug
ewo+ICsJCQkJCXJldCA9IEVDQ19FUlJfQ05UMF9WNihiY2hfc3QpOwo+ICsJCQkJCW10ZC0+ZWNj
X3N0YXRzLmNvcnJlY3RlZCArPSByZXQ7Cj4gKwkJCQkJYml0ZmxpcHMgPSBtYXhfdCh1MzIsIGJp
dGZsaXBzLCByZXQpOwo+ICsKPiArCQkJCQlyZXQgPSBFQ0NfRVJSX0NOVDFfVjYoYmNoX3N0KTsK
PiArCQkJCQltdGQtPmVjY19zdGF0cy5jb3JyZWN0ZWQgKz0gcmV0Owo+ICsJCQkJCWJpdGZsaXBz
ID0gbWF4X3QodTMyLCBiaXRmbGlwcywgcmV0KTsKPiArCQkJCX0KPiArCQkJfQo+ICsJCX0gZWxz
ZSB7Cj4gKwkJCWZvciAoaSA9IDA7IGkgPCBlY2MtPnN0ZXBzIC8gMjsgaSsrKSB7Cj4gKwkJCQli
Y2hfc3QgPSBuZmNfcmVhZGwobmZjLCBORkNfQkNIX1NUX1Y5ICsgaSAqIDQpOwo+ICsJCQkJaWYg
KGJjaF9zdCAmIEJDSF9TVF9FUlIwX1Y5IHx8Cj4gKwkJCQkgICAgYmNoX3N0ICYgQkNIX1NUX0VS
UjBfVjkpIHsKPiArCQkJCQltdGQtPmVjY19zdGF0cy5mYWlsZWQrKzsKPiArCQkJCQliaXRmbGlw
cyA9IC0xOwo+ICsJCQkJfSBlbHNlIHsKPiArCQkJCQlyZXQgPSBFQ0NfRVJSX0NOVDBfVjkoYmNo
X3N0KTsKPiArCQkJCQltdGQtPmVjY19zdGF0cy5jb3JyZWN0ZWQgKz0gcmV0Owo+ICsJCQkJCWJp
dGZsaXBzID0gbWF4X3QodTMyLCBiaXRmbGlwcywgcmV0KTsKPiArCmxvb2tzIHN0cmFuZ2UsIGEg
c3dpdGNoIHdvdWxkIGJlIGJldHRlciBwcm9iYWJseS4KCj4gKwkJCQkJcmV0ID0gRUNDX0VSUl9D
TlQxX1Y5KGJjaF9zdCk7Cj4gKwkJCQkJbXRkLT5lY2Nfc3RhdHMuY29ycmVjdGVkICs9IHJldDsK
PiArCQkJCQliaXRmbGlwcyA9IG1heF90KHUzMiwgYml0ZmxpcHMsIHJldCk7Cj4gKwkJCQl9Cj4g
KwkJCX0KPiArCQl9Cj4gKwkJbWVtY3B5KGJ1ZiwgbmZjLT5wYWdlX2J1ZiwgbXRkLT53cml0ZXNp
emUpOwo+ICsKPiArCQlpZiAoYml0ZmxpcHMgPT0gLTEpCj4gKwkJCWRldl9lcnIobmZjLT5kZXYs
ICJyZWFkX3BhZ2UgJXggJXggJXggJXggJXggJXhcbiIsCj4gKwkJCQlwYWdlLCBiaXRmbGlwcywg
YmNoX3N0LCAoKHUzMiAqKWJ1ZilbMF0sCj4gKwkJCQkoKHUzMiAqKWJ1ZilbMV0sICh1MzIpZG1h
X2RhdGEpOwo+ICsJfSBlbHNlIHsKPiArCQlya19uZmNfcmVhZF9idWYoY2hpcCwgYnVmLCBtdGQt
PndyaXRlc2l6ZSArIG10ZC0+b29ic2l6ZSk7Cj4gKwl9CgpzcGFjZQoKPiArCXJldHVybiBiaXRm
bGlwczsKPiArfQo+ICsKPiArc3RhdGljIGludCBya19uZmNfd3JpdGVfcGFnZV9od2VjYyhzdHJ1
Y3QgbmFuZF9jaGlwICpjaGlwLCBjb25zdCB1OCAqYnVmLAo+ICsJCQkJICAgIGludCBvb2Jfb24s
IGludCBwYWdlKQo+ICt7Cj4gKwlyZXR1cm4gcmtfbmZjX3dyaXRlX3BhZ2UobmFuZF90b19tdGQo
Y2hpcCksIGNoaXAsIGJ1ZiwgcGFnZSwgMCk7Cj4gK30KCldoYXQgaXMgdGhlIHB1cnBvc2Ugb2Yg
dGhpcyBpbmRpcmVjdGlvbj8KCj4gKwo+ICtzdGF0aWMgaW50IHJrX25mY19yZWFkX3BhZ2VfaHdl
Y2Moc3RydWN0IG5hbmRfY2hpcCAqY2hpcCwgdTggKnAsIGludCBvb2Jfb24sCj4gKwkJCQkgICBp
bnQgcGcpCj4gK3sKPiArCXN0cnVjdCBtdGRfaW5mbyAqbXRkID0gbmFuZF90b19tdGQoY2hpcCk7
Cj4gKwo+ICsJcmV0dXJuIHJrX25mY19yZWFkX3BhZ2UobXRkLCBjaGlwLCAwLCBtdGQtPndyaXRl
c2l6ZSwgcCwgcGcsIDApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHJrX25mY19yZWFkX3BhZ2Vf
cmF3KHN0cnVjdCBuYW5kX2NoaXAgKmNoaXAsIHU4ICpidWYsIGludCBvb2Jfb24sCj4gKwkJCQkg
aW50IHBhZ2UpCj4gK3sKPiArCXN0cnVjdCBtdGRfaW5mbyAqbXRkID0gbmFuZF90b19tdGQoY2hp
cCk7Cj4gKwlzdHJ1Y3QgcmtfbmZjICpuZmMgPSBuYW5kX2dldF9jb250cm9sbGVyX2RhdGEoY2hp
cCk7Cj4gKwlpbnQgaSwgcmV0Owo+ICsKPiArCXJldCA9IHJrX25mY19yZWFkX3BhZ2UobXRkLCBj
aGlwLCAwLCBtdGQtPndyaXRlc2l6ZSwgbmZjLT5idWZmZXIsCj4gKwkJCQkgICBwYWdlLCAxKTsK
PiArCWlmIChyZXQgPCAwKQo+ICsJCXJldHVybiByZXQ7Cj4gKwo+ICsJZm9yIChpID0gMDsgaSA8
IGNoaXAtPmVjYy5zdGVwczsgaSsrKSB7Cj4gKwkJbWVtY3B5KG9vYl9wdHIoY2hpcCwgaSksIHJr
X29vYl9wdHIoY2hpcCwgaSksCj4gKwkJICAgICAgIE5GQ19TWVNfREFUQV9TSVpFKTsKPiArCj4g
KwkJaWYgKGJ1ZikKPiArCQkJbWVtY3B5KGRhdGFfcHRyKGNoaXAsIGJ1ZiwgaSksIHJrX2RhdGFf
cHRyKGNoaXAsIGkpLAo+ICsJCQkgICAgICAgY2hpcC0+ZWNjLnNpemUpOwo+ICsJfQo+ICsJc3dh
cChjaGlwLT5vb2JfcG9pWzBdLCBjaGlwLT5vb2JfcG9pWzddKTsKPiArCj4gKwlyZXR1cm4gcmV0
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHJrX25mY19yZWFkX29vYl9zdGQoc3RydWN0IG5hbmRf
Y2hpcCAqY2hpcCwgaW50IHBhZ2UpCj4gK3sKPiArCXJldHVybiBya19uZmNfcmVhZF9wYWdlX3Jh
dyhjaGlwLCBOVUxMLCAxLCBwYWdlKTsKPiArfQo+ICsKPiArc3RhdGljIGlubGluZSB2b2lkIHJr
X25mY19od19pbml0KHN0cnVjdCBya19uZmMgKm5mYykKPiArewo+ICsJdTMyIHZhbDsKPiArCj4g
Kwl2YWwgPSBuZmNfcmVhZGwobmZjLCBORkNfVkVSX1Y5KTsKPiArCWlmICh2YWwgPT0gTkZDX1ZF
UlNJT05fOSkgewo+ICsJCW5mYy0+bmZjX3ZlcnNpb24gPSA5Owo+ICsJCW5mYy0+bWF4X2VjY19z
dHJlbmd0aCA9IDcwOwo+ICsJfSBlbHNlIHsKPiArCQluZmMtPm5mY192ZXJzaW9uID0gNjsKPiAr
CQl2YWwgPSBuZmNfcmVhZGwobmZjLCBORkNfVkVSX1Y2KTsKPiArCQlpZiAodmFsID09IDB4ODAx
KQo+ICsJCQluZmMtPm1heF9lY2Nfc3RyZW5ndGggPSAxNjsKPiArCQllbHNlCj4gKwkJCW5mYy0+
bWF4X2VjY19zdHJlbmd0aCA9IDYwOwo+ICsJfQo+ICsKPiArCS8qIGRpc2FibGUgZmxhc2ggd3Ag
Ki8KPiArCW5mY193cml0ZWwobmZjLCBGTUNUTF9XUCwgIE5GQ19GTUNUTCk7Cj4gKwkvKiBjb25m
aWcgZGVmYXVsdCB0aW1pbmcgKi8KPiArCW5mY193cml0ZWwobmZjLCAweDEwODEsICBORkNfRk1X
QUlUKTsKPiArCS8qIGRpc2FibGUgcmFuZG9taXplciBhbmQgZG1hICovCj4gKwo+ICsJaWYgKG5m
Yy0+bmZjX3ZlcnNpb24gPT0gNikgewo+ICsJCW5mY193cml0ZWwobmZjLCAwLCBORkNfUkFORE1a
X1Y2KTsKPiArCQluZmNfd3JpdGVsKG5mYywgMCwgTkZDX0RNQV9DRkdfVjYpOwo+ICsJCW5mY193
cml0ZWwobmZjLCBGTENUTF9SU1QsIE5GQ19GTENUTF9WNik7Cj4gKwl9IGVsc2Ugewo+ICsJCW5m
Y193cml0ZWwobmZjLCAwLCBORkNfUkFORE1aX1Y5KTsKPiArCQluZmNfd3JpdGVsKG5mYywgMCwg
TkZDX0RNQV9DRkdfVjkpOwo+ICsJCW5mY193cml0ZWwobmZjLCBGTENUTF9SU1QsIE5GQ19GTENU
TF9WOSk7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBpcnFyZXR1cm5fdCBya19uZmNfaXJxKGlu
dCBpcnEsIHZvaWQgKmlkKQo+ICt7Cj4gKwlzdHJ1Y3QgcmtfbmZjICpuZmMgPSBpZDsKPiArCXUz
MiBzdGEsIGllbjsKPiArCj4gKwlpZiAobmZjLT5uZmNfdmVyc2lvbiA9PSA2KSB7Cj4gKwkJc3Rh
ID0gbmZjX3JlYWRsKG5mYywgTkZDX0lOVFNUX1Y2KTsKPiArCQlpZW4gPSBuZmNfcmVhZGwobmZj
LCBORkNfSU5URU5fVjYpOwo+ICsJfSBlbHNlIHsKPiArCQlzdGEgPSBuZmNfcmVhZGwobmZjLCBO
RkNfSU5UU1RfVjkpOwo+ICsJCWllbiA9IG5mY19yZWFkbChuZmMsIE5GQ19JTlRFTl9WOSk7Cj4g
Kwl9Cj4gKwo+ICsJaWYgKCEoc3RhICYgaWVuKSkKPiArCQlyZXR1cm4gSVJRX05PTkU7Cj4gKwlp
ZiAobmZjLT5uZmNfdmVyc2lvbiA9PSA2KSB7Cj4gKwkJbmZjX3dyaXRlbChuZmMsIHN0YSwgTkZD
X0lOVENMUl9WNik7Cj4gKwkJbmZjX3dyaXRlbChuZmMsIH5zdGEgJiBpZW4sIE5GQ19JTlRFTl9W
Nik7Cj4gKwl9IGVsc2Ugewo+ICsJCW5mY193cml0ZWwobmZjLCBzdGEsIE5GQ19JTlRDTFJfVjkp
Owo+ICsJCW5mY193cml0ZWwobmZjLCB+c3RhICYgaWVuLCBORkNfSU5URU5fVjkpOwo+ICsJfQo+
ICsJY29tcGxldGUoJm5mYy0+ZG9uZSk7Cj4gKwo+ICsJcmV0dXJuIElSUV9IQU5ETEVEOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgaW50IHJrX25mY19lbmFibGVfY2xrKHN0cnVjdCBkZXZpY2UgKmRldiwg
c3RydWN0IHJrX25mY19jbGsgKmNsaykKPiArewo+ICsJaW50IHJldDsKPiArCj4gKwlyZXQgPSBj
bGtfcHJlcGFyZV9lbmFibGUoY2xrLT5uZmNfY2xrKTsKPiArCWlmIChyZXQpIHsKPiArCQlkZXZf
ZXJyKGRldiwgImZhaWxlZCB0byBlbmFibGUgbmZjIGNsa1xuIik7Cj4gKwkJcmV0dXJuIHJldDsK
PiArCX0KPiArCj4gKwlyZXQgPSBjbGtfcHJlcGFyZV9lbmFibGUoY2xrLT5haGJfY2xrKTsKPiAr
CWlmIChyZXQpIHsKPiArCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBlbmFibGUgYWhiIGNsa1xu
Iik7Cj4gKwkJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGNsay0+bmZjX2Nsayk7Cj4gKwkJcmV0dXJu
IHJldDsKPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgcmtf
bmZjX2Rpc2FibGVfY2xrKHN0cnVjdCBya19uZmNfY2xrICpjbGspCj4gK3sKPiArCWNsa19kaXNh
YmxlX3VucHJlcGFyZShjbGstPm5mY19jbGspOwo+ICsJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGNs
ay0+YWhiX2Nsayk7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgcmtfbmZjX29vYmxheW91dF9mcmVl
KHN0cnVjdCBtdGRfaW5mbyAqbXRkLCBpbnQgc2VjdGlvbiwKPiArCQkJCSAgc3RydWN0IG10ZF9v
b2JfcmVnaW9uICpvb2JfcmVnaW9uKQo+ICt7Cj4gKwlzdHJ1Y3QgbmFuZF9jaGlwICpjaGlwID0g
bXRkX3RvX25hbmQobXRkKTsKPiArCj4gKwlpZiAoc2VjdGlvbiA+PSBjaGlwLT5lY2Muc3RlcHMp
Cj4gKwkJcmV0dXJuIC1FUkFOR0U7Cj4gKwo+ICsJaWYgKCFzZWN0aW9uKSB7Cj4gKwkJLyogVGhl
IGZpcnN0IGJ5dGUgaXMgYmFkIGJsb2NrIG1hc2sgZmxhZyAqLwo+ICsJCW9vYl9yZWdpb24tPmxl
bmd0aCA9IE5GQ19TWVNfREFUQV9TSVpFIC0gMTsKPiArCQlvb2JfcmVnaW9uLT5vZmZzZXQgPSAx
Owo+ICsJfSBlbHNlIHsKPiArCQlvb2JfcmVnaW9uLT5sZW5ndGggPSBORkNfU1lTX0RBVEFfU0la
RTsKPiArCQlvb2JfcmVnaW9uLT5vZmZzZXQgPSBzZWN0aW9uICogTkZDX1NZU19EQVRBX1NJWkU7
Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgcmtfbmZjX29v
YmxheW91dF9lY2Moc3RydWN0IG10ZF9pbmZvICptdGQsIGludCBzZWN0aW9uLAo+ICsJCQkJIHN0
cnVjdCBtdGRfb29iX3JlZ2lvbiAqb29iX3JlZ2lvbikKPiArewo+ICsJc3RydWN0IG5hbmRfY2hp
cCAqY2hpcCA9IG10ZF90b19uYW5kKG10ZCk7Cj4gKwo+ICsJaWYgKHNlY3Rpb24pCj4gKwkJcmV0
dXJuIC1FUkFOR0U7Cj4gKwo+ICsJb29iX3JlZ2lvbi0+b2Zmc2V0ID0gTkZDX1NZU19EQVRBX1NJ
WkUgKiBjaGlwLT5lY2Muc3RlcHM7Cj4gKwlvb2JfcmVnaW9uLT5sZW5ndGggPSBtdGQtPm9vYnNp
emUgLSBvb2JfcmVnaW9uLT5vZmZzZXQ7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgbXRkX29vYmxheW91dF9vcHMgcmtfbmZjX29vYmxheW91dF9vcHMg
PSB7Cj4gKwkuZnJlZSA9IHJrX25mY19vb2JsYXlvdXRfZnJlZSwKPiArCS5lY2MgPSBya19uZmNf
b29ibGF5b3V0X2VjYywKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQgcmtfbmZjX2h3X2VjY19zZXR1
cChzdHJ1Y3QgbXRkX2luZm8gKm10ZCwKPiArCQkJCSBzdHJ1Y3QgbmFuZF9lY2NfY3RybCAqZWNj
LAo+ICsJCQkJIHVpbnQzMl90IHN0cmVuZ3RoKQo+ICt7Cj4gKwlzdHJ1Y3QgbmFuZF9jaGlwICpu
YW5kID0gbXRkX3RvX25hbmQobXRkKTsKPiArCXN0cnVjdCBya19uZmMgKm5mYyA9IG5hbmRfZ2V0
X2NvbnRyb2xsZXJfZGF0YShuYW5kKTsKPiArCXUzMiByZWc7Cj4gKwo+ICsJZWNjLT5zdHJlbmd0
aCA9IHN0cmVuZ3RoOwo+ICsJZWNjLT5zdGVwcyA9IG10ZC0+d3JpdGVzaXplIC8gZWNjLT5zaXpl
Owo+ICsJZWNjLT5ieXRlcyA9IERJVl9ST1VORF9VUChlY2MtPnN0cmVuZ3RoICogMTQsIDgpOwo+
ICsJLyogSFcgRUNDIGFsd2F5cyB3b3JrIHdpdGggZXZlbiBudW1iZXJzIG9mIEVDQyBieXRlcyAq
Lwo+ICsJZWNjLT5ieXRlcyA9IEFMSUdOKGVjYy0+Ynl0ZXMsIDIpOwo+ICsKPiArCWlmIChuZmMt
Pm5mY192ZXJzaW9uID09IDYpIHsKPiArCQlzd2l0Y2ggKGVjYy0+c3RyZW5ndGgpIHsKPiArCQlj
YXNlIDYwOgo+ICsJCQlyZWcgPSAweDAwMDQwMDEwOwo+ICsJCQlicmVhazsKPiArCQljYXNlIDQw
Ogo+ICsJCQlyZWcgPSAweDAwMDQwMDAwOwo+ICsJCQlicmVhazsKPiArCQljYXNlIDI0Ogo+ICsJ
CQlyZWcgPSAweDAwMDAwMDEwOwo+ICsJCQlicmVhazsKPiArCQljYXNlIDE2Ogo+ICsJCQlyZWcg
PSAweDAwMDAwMDAwOwo+ICsJCQlicmVhazsKPiArCQlkZWZhdWx0Ogo+ICsJCQlyZXR1cm4gLUVJ
TlZBTDsKPiArCQl9Cj4gKwkJbmZjX3dyaXRlbChuZmMsIHJlZywgTkZDX0JDSENUTF9WNik7Cj4g
Kwl9IGVsc2Ugewo+ICsJCXN3aXRjaCAoZWNjLT5zdHJlbmd0aCkgewo+ICsJCWNhc2UgNzA6Cj4g
KwkJCXJlZyA9IDB4MDAwMDAwMDE7Cj4gKwkJCWJyZWFrOwo+ICsJCWNhc2UgNjA6Cj4gKwkJCXJl
ZyA9IDB4MDYwMDAwMDE7Cj4gKwkJCWJyZWFrOwo+ICsJCWNhc2UgNDA6Cj4gKwkJCXJlZyA9IDB4
MDQwMDAwMDE7Cj4gKwkJCWJyZWFrOwo+ICsJCWNhc2UgMTY6Cj4gKwkJCXJlZyA9IDB4MDIwMDAw
MDE7Cj4gKwkJCWJyZWFrOwo+ICsJCWRlZmF1bHQ6Cj4gKwkJCXJldHVybiAtRUlOVkFMOwo+ICsJ
CX0KPiArCQluZmNfd3JpdGVsKG5mYywgcmVnLCBORkNfQkNIQ1RMX1Y5KTsKPiArCX0KPiArCj4g
KwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBya19uZmNfZWNjX2luaXQoc3RydWN0
IGRldmljZSAqZGV2LCBzdHJ1Y3QgbXRkX2luZm8gKm10ZCkKPiArewo+ICsJc3RydWN0IG5hbmRf
Y2hpcCAqbmFuZCA9IG10ZF90b19uYW5kKG10ZCk7Cj4gKwlzdHJ1Y3QgcmtfbmZjICpuZmMgPSBu
YW5kX2dldF9jb250cm9sbGVyX2RhdGEobmFuZCk7Cj4gKwlzdHJ1Y3QgbmFuZF9lY2NfY3RybCAq
ZWNjID0gJm5hbmQtPmVjYzsKPiArCXN0YXRpYyB1OCBzdHJlbmd0aHNfdjlbNF0gPSB7NzAsIDYw
LCA0MCwgMTZ9Owo+ICsJc3RhdGljIHU4IHN0cmVuZ3Roc192Nls0XSA9IHs2MCwgNDAsIDI0LCAx
Nn07Cj4gKwl1OCAqc3RyZW5ndGhzOwo+ICsJdTMyIG1heF9zdHJlbmd0aDsKPiArCWludCBpOwo+
ICsKPiArCS8qIHN1cHBvcnQgb25seSBlY2MgaHcgbW9kZSAqLwo+ICsJaWYgKGVjYy0+bW9kZSAh
PSBOQU5EX0VDQ19IVykgewo+ICsJCWRldl9lcnIoZGV2LCAiZWNjLm1vZGUgbm90IHN1cHBvcnRl
ZFxuIik7Cj4gKwkJcmV0dXJuIC1FSU5WQUw7CgpObywgcGxlYXNlIHN1cHBvcnQgdGhlIGFic2Vu
Y2Ugb2YgRUNDIChtaWdodCBiZSB1c2VmdWwgZm9yCmRldmVsb3BtZW50L3Rlc3RpbmcgaW4gc29t
ZSBjb25kaXRpb25zKSBhbmQgaGF2aW5nIHNvZndhcmUgRUNDIHN1cHBvcnQuCgo+ICsJfQo+ICsK
PiArCS8qIGlmIG9wdGlvbmFsIGR0IHNldHRpbmdzIG5vdCBwcmVzZW50ICovCj4gKwlpZiAoIWVj
Yy0+c2l6ZSB8fCAhZWNjLT5zdHJlbmd0aCB8fAo+ICsJICAgIGVjYy0+c3RyZW5ndGggPiBuZmMt
Pm1heF9lY2Nfc3RyZW5ndGgpIHsKPiArCQkvKiB1c2UgZGF0YXNoZWV0IHJlcXVpcmVtZW50cyAq
Lwo+ICsJCWVjYy0+c3RyZW5ndGggPSBuYW5kLT5iYXNlLmVjY3JlcS5zdHJlbmd0aDsKPiArCQll
Y2MtPnNpemUgPSBuYW5kLT5iYXNlLmVjY3JlcS5zdGVwX3NpemU7Cj4gKwo+ICsJCS8qCj4gKwkJ
ICogYWxpZ24gZWNjc3RyZW5ndGggYW5kIGVjY3NpemUKPiArCQkgKiB0aGlzIGNvbnRyb2xsZXIg
b25seSBzdXBwb3J0cyA1MTIgYW5kIDEwMjQgc2l6ZXMKPiArCQkgKi8KPiArCQlpZiAobmFuZC0+
ZWNjLnNpemUgPCAxMDI0KSB7Cj4gKwkJCWlmIChtdGQtPndyaXRlc2l6ZSA+IDUxMikgewo+ICsJ
CQkJbmFuZC0+ZWNjLnNpemUgPSAxMDI0Owo+ICsJCQkJbmFuZC0+ZWNjLnN0cmVuZ3RoIDw8PSAx
Owo+ICsJCQl9IGVsc2Ugewo+ICsJCQkJZGV2X2VycihkZXYsICJlY2Muc2l6ZSBub3Qgc3VwcG9y
dGVkXG4iKTsKPiArCQkJCXJldHVybiAtRUlOVkFMOwo+ICsJCQl9Cj4gKwkJfSBlbHNlIHsKPiAr
CQkJbmFuZC0+ZWNjLnNpemUgPSAxMDI0Owo+ICsJCX0KPiArCj4gKwkJZWNjLT5zdGVwcyA9IG10
ZC0+d3JpdGVzaXplIC8gZWNjLT5zaXplOwo+ICsJCW1heF9zdHJlbmd0aCA9ICgobXRkLT5vb2Jz
aXplIC8gZWNjLT5zdGVwcykgLSA0KSAqIDggLyAxNDsKPiArCQlpZiAobWF4X3N0cmVuZ3RoID4g
bmZjLT5tYXhfZWNjX3N0cmVuZ3RoKQo+ICsJCQltYXhfc3RyZW5ndGggPSBuZmMtPm1heF9lY2Nf
c3RyZW5ndGg7Cj4gKwo+ICsJCXN0cmVuZ3RocyA9IHN0cmVuZ3Roc192OTsKPiArCQlpZiAobmZj
LT5uZmNfdmVyc2lvbiA9PSA2KQo+ICsJCQlzdHJlbmd0aHMgPSBzdHJlbmd0aHNfdjY7Cj4gKwo+
ICsJCWZvciAoaSA9IDA7IGkgPCA0OyBpKyspIHsKPiArCQkJaWYgKG1heF9zdHJlbmd0aCA+PSBz
dHJlbmd0aHNbaV0pCj4gKwkJCQlicmVhazsKPiArCQl9Cj4gKwo+ICsJCWlmIChpID49IDQpIHsK
PiArCQkJZGV2X2VycihuZmMtPmRldiwgInVuc3VwcG9ydGVkIHN0cmVuZ3RoXG4iKTsKPiArCQkJ
cmV0dXJuIC1FTk9UU1VQUDsKPiArCQl9Cj4gKwo+ICsJCWVjYy0+c3RyZW5ndGggPSBzdHJlbmd0
aHNbaV07Cj4gKwl9Cj4gKwlya19uZmNfaHdfZWNjX3NldHVwKG10ZCwgZWNjLCBlY2MtPnN0cmVu
Z3RoKTsKPiArCWRldl9pbmZvKGRldiwgImVjY3NpemUgJWQgZWNjc3RyZW5ndGggJWRcbiIsCj4g
KwkJIG5hbmQtPmVjYy5zaXplLCBuYW5kLT5lY2Muc3RyZW5ndGgpOwoKc3BhY2UKCj4gKwlyZXR1
cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBya19uZmNfYXR0YWNoX2NoaXAoc3RydWN0IG5h
bmRfY2hpcCAqY2hpcCkKPiArewo+ICsJc3RydWN0IG10ZF9pbmZvICptdGQgPSBuYW5kX3RvX210
ZChjaGlwKTsKPiArCXN0cnVjdCBkZXZpY2UgKmRldiA9IG10ZC0+ZGV2LnBhcmVudDsKPiArCXN0
cnVjdCBya19uZmMgKm5mYyA9IG5hbmRfZ2V0X2NvbnRyb2xsZXJfZGF0YShjaGlwKTsKPiArCXN0
cnVjdCBya19uZmNfbmFuZF9jaGlwICpya19uYW5kID0gdG9fcmtfbmFuZChjaGlwKTsKPiArCXN0
cnVjdCBuYW5kX2VjY19jdHJsICplY2MgPSAmY2hpcC0+ZWNjOwo+ICsJaW50IGxlbjsKPiArCWlu
dCByZXQ7Cj4gKwo+ICsJaWYgKGNoaXAtPm9wdGlvbnMgJiBOQU5EX0JVU1dJRFRIXzE2KSB7Cj4g
KwkJZGV2X2VycihkZXYsICIxNmJpdHMgYnVzd2lkdGggbm90IHN1cHBvcnRlZCIpOwo+ICsJCXJl
dHVybiAtRUlOVkFMOwo+ICsJfQo+ICsKPiArCXJldCA9IHJrX25mY19lY2NfaW5pdChkZXYsIG10
ZCk7Cj4gKwlpZiAocmV0KQo+ICsJCXJldHVybiByZXQ7Cj4gKwlya19uYW5kLT5zcGFyZV9wZXJf
c2VjdG9yID0gZWNjLT5ieXRlcyArIE5GQ19TWVNfREFUQV9TSVpFOwo+ICsKPiArCS8qIENoZWNr
IGJ1ZmZlciBmaXJzdCwgYXZvaWQgZHVwbGljYXRlIGFsbG9jIGJ1ZmZlciAqLwo+ICsJaWYgKG5m
Yy0+YnVmZmVyKQo+ICsJCXJldHVybiAwOwo+ICsKPiArCWxlbiA9IG10ZC0+d3JpdGVzaXplICsg
bXRkLT5vb2JzaXplOwo+ICsJbmZjLT5idWZmZXIgPSBkZXZtX2t6YWxsb2MoZGV2LCBsZW4sIEdG
UF9LRVJORUwgfCBHRlBfRE1BKTsKPiArCWlmICghbmZjLT5idWZmZXIpCj4gKwkJcmV0dXJuICAt
RU5PTUVNOwoKICAgICAgICAgICAgICAgICAgICAgICBeCgpBdm9pZCB0aGVzZSBleHRyYSBzcGFj
ZXMgaW4gYWxsIHlvdXIgcmV0dXJuIHN0YXRlbWVudHMuCgpQbGVhc2UgcnVuIHNjcmlwdHMvY2hl
Y2twYXRjaC5wbCAtLXN0cmljdAoKPiArCj4gKwluZmMtPnBhZ2VfYnVmID0gbmZjLT5idWZmZXI7
Cj4gKwlsZW4gPSBlY2MtPnN0ZXBzICogMTI4OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IF4KQSBkZWZpbml0aW9uIG9mIHRoaXMgd291bGQgYmUgZ3JlYXQgdG9vCgo+ICsJbmZjLT5vb2Jf
YnVmID0gZGV2bV9remFsbG9jKGRldiwgbGVuLCBHRlBfS0VSTkVMIHwgR0ZQX0RNQSk7Cj4gKwlp
ZiAoIW5mYy0+b29iX2J1Zikgewo+ICsJCWRldm1fa2ZyZWUoZGV2LCBuZmMtPmJ1ZmZlcik7Cj4g
KwkJbmZjLT5idWZmZXIgPSBOVUxMOwo+ICsJCW5mYy0+b29iX2J1ZiA9IE5VTEw7Cj4gKwkJcmV0
dXJuICAtRU5PTUVNOwo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
Y29uc3Qgc3RydWN0IG5hbmRfY29udHJvbGxlcl9vcHMgcmtfbmZjX2NvbnRyb2xsZXJfb3BzID0g
ewo+ICsJLmF0dGFjaF9jaGlwID0gcmtfbmZjX2F0dGFjaF9jaGlwLAo+ICsJLnNldHVwX2RhdGFf
aW50ZXJmYWNlID0gcmtfbmZjX3NldHVwX2RhdGFfaW50ZXJmYWNlLAo+ICt9Owo+ICsKPiArc3Rh
dGljIGludCBya19uZmNfbmFuZF9jaGlwX2luaXQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3Qg
cmtfbmZjICpuZmMsCj4gKwkJCQkgIHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnApCj4gK3sKPiArCXN0
cnVjdCBya19uZmNfbmFuZF9jaGlwICpjaGlwOwo+ICsJc3RydWN0IG5hbmRfY2hpcCAqbmFuZDsK
PiArCXN0cnVjdCBtdGRfaW5mbyAqbXRkOwo+ICsJaW50IG5zZWxzOwo+ICsJdTMyIHRtcDsKPiAr
CWludCByZXQ7Cj4gKwlpbnQgaTsKPiArCj4gKwlpZiAoIW9mX2dldF9wcm9wZXJ0eShucCwgInJl
ZyIsICZuc2VscykpCj4gKwkJcmV0dXJuIC1FTk9ERVY7Cj4gKwluc2VscyAvPSBzaXplb2YodTMy
KTsKPiArCWlmICghbnNlbHMgfHwgbnNlbHMgPiBSS19OQU5EX01BWF9OU0VMUykgewo+ICsJCWRl
dl9lcnIoZGV2LCAiaW52YWxpZCByZWcgcHJvcGVydHkgc2l6ZSAlZFxuIiwgbnNlbHMpOwo+ICsJ
CXJldHVybiAtRUlOVkFMOwo+ICsJfQo+ICsKPiArCWNoaXAgPSBkZXZtX2t6YWxsb2MoZGV2LCBz
aXplb2YoKmNoaXApICsgbnNlbHMgKiBzaXplb2YodTgpLAo+ICsJCQkgICAgR0ZQX0tFUk5FTCk7
Cj4gKwlpZiAoIWNoaXApCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJY2hpcC0+bnNlbHMg
PSBuc2VsczsKPiArCWZvciAoaSA9IDA7IGkgPCBuc2VsczsgaSsrKSB7Cj4gKwkJcmV0ID0gb2Zf
cHJvcGVydHlfcmVhZF91MzJfaW5kZXgobnAsICJyZWciLCBpLCAmdG1wKTsKPiArCQlpZiAocmV0
KSB7Cj4gKwkJCWRldl9lcnIoZGV2LCAicmVnIHByb3BlcnR5IGZhaWx1cmUgOiAlZFxuIiwgcmV0
KTsKPiArCQkJcmV0dXJuIHJldDsKPiArCQl9Cj4gKwo+ICsJCWlmICh0bXAgPj0gUktfTkFORF9N
QVhfTlNFTFMpIHsKPiArCQkJZGV2X2VycihkZXYsICJpbnZhbGlkIENTOiAldVxuIiwgdG1wKTsK
PiArCQkJcmV0dXJuIC1FSU5WQUw7Cj4gKwkJfQo+ICsKPiArCQlpZiAodGVzdF9hbmRfc2V0X2Jp
dCh0bXAsICZuZmMtPmFzc2lnbmVkX2NzKSkgewo+ICsJCQlkZXZfZXJyKGRldiwgIkNTICV1IGFs
cmVhZHkgYXNzaWduZWRcbiIsIHRtcCk7Cj4gKwkJCXJldHVybiAtRUlOVkFMOwo+ICsJCX0KPiAr
Cj4gKwkJY2hpcC0+c2Vsc1tpXSA9IHRtcDsKPiArCX0KPiArCj4gKwluYW5kID0gJmNoaXAtPm5h
bmQ7Cj4gKwluYW5kLT5jb250cm9sbGVyID0gJm5mYy0+Y29udHJvbGxlcjsKPiArCj4gKwluYW5k
X3NldF9mbGFzaF9ub2RlKG5hbmQsIG5wKTsKPiArCW5hbmRfc2V0X2NvbnRyb2xsZXJfZGF0YShu
YW5kLCBuZmMpOwo+ICsKPiArCW5hbmQtPm9wdGlvbnMgfD0gTkFORF9VU0VfQk9VTkNFX0JVRkZF
UiB8IE5BTkRfTk9fU1VCUEFHRV9XUklURTsKPiArCW5hbmQtPmJidF9vcHRpb25zID0gTkFORF9C
QlRfVVNFX0ZMQVNIIHwgTkFORF9CQlRfTk9fT09COwo+ICsJbmFuZC0+bGVnYWN5LmRldl9yZWFk
eSA9IHJrX25mY19kZXZfcmVhZHk7Cj4gKwluYW5kLT5sZWdhY3kuc2VsZWN0X2NoaXAgPSBya19u
ZmNfc2VsZWN0X2NoaXA7Cj4gKwluYW5kLT5sZWdhY3kud3JpdGVfYnl0ZSA9IHJrX25mY193cml0
ZV9ieXRlOwo+ICsJbmFuZC0+bGVnYWN5LndyaXRlX2J1ZiA9IHJrX25mY193cml0ZV9idWY7Cj4g
KwluYW5kLT5sZWdhY3kucmVhZF9ieXRlID0gcmtfbmZjX3JlYWRfYnl0ZTsKPiArCW5hbmQtPmxl
Z2FjeS5yZWFkX2J1ZiA9IHJrX25mY19yZWFkX2J1ZjsKPiArCW5hbmQtPmxlZ2FjeS5jbWRfY3Ry
bCA9IHJrX25mY19jbWRfY3RybDsKCllvdSBzaG91bGQgbm90IGltcGxlbWVudCBhbnkgbGVnYWN5
IGhvb2tzLgoKPiArCj4gKwkvKiBzZXQgZGVmYXVsdCBtb2RlIGluIGNhc2UgZHQgZW50cnkgaXMg
bWlzc2luZyAqLwo+ICsJbmFuZC0+ZWNjLm1vZGUgPSBOQU5EX0VDQ19IVzsKPiArCj4gKwluYW5k
LT5lY2Mud3JpdGVfcGFnZV9yYXcgPSBya19uZmNfd3JpdGVfcGFnZV9yYXc7Cj4gKwluYW5kLT5l
Y2Mud3JpdGVfcGFnZSA9IHJrX25mY193cml0ZV9wYWdlX2h3ZWNjOwo+ICsJbmFuZC0+ZWNjLndy
aXRlX29vYl9yYXcgPSBya19uZmNfd3JpdGVfb29iX3N0ZDsKPiArCW5hbmQtPmVjYy53cml0ZV9v
b2IgPSBya19uZmNfd3JpdGVfb29iX3N0ZDsKPiArCj4gKwluYW5kLT5lY2MucmVhZF9wYWdlX3Jh
dyA9IHJrX25mY19yZWFkX3BhZ2VfcmF3Owo+ICsJbmFuZC0+ZWNjLnJlYWRfcGFnZSA9IHJrX25m
Y19yZWFkX3BhZ2VfaHdlY2M7Cj4gKwluYW5kLT5lY2MucmVhZF9vb2JfcmF3ID0gcmtfbmZjX3Jl
YWRfb29iX3N0ZDsKPiArCW5hbmQtPmVjYy5yZWFkX29vYiA9IHJrX25mY19yZWFkX29vYl9zdGQ7
Cj4gKwo+ICsJbXRkID0gbmFuZF90b19tdGQobmFuZCk7Cj4gKwltdGQtPm93bmVyID0gVEhJU19N
T0RVTEU7Cj4gKwltdGQtPmRldi5wYXJlbnQgPSBkZXY7Cj4gKwltdGQtPm5hbWUgPSBUSElTX05B
TUU7Cj4gKwltdGRfc2V0X29vYmxheW91dChtdGQsICZya19uZmNfb29ibGF5b3V0X29wcyk7Cj4g
Kwlya19uZmNfaHdfaW5pdChuZmMpOwo+ICsJcmV0ID0gbmFuZF9zY2FuKG5hbmQsIG5zZWxzKTsK
PiArCWlmIChyZXQpCj4gKwkJcmV0dXJuIHJldDsKPiArCXJldCA9IG10ZF9kZXZpY2VfcmVnaXN0
ZXIobXRkLCBOVUxMLCAwKTsKPiArCWlmIChyZXQpIHsKPiArCQlkZXZfZXJyKGRldiwgIm10ZCBw
YXJzZSBwYXJ0aXRpb24gZXJyb3JcbiIpOwo+ICsJCW5hbmRfcmVsZWFzZShuYW5kKTsKPiArCQly
ZXR1cm4gcmV0Owo+ICsJfQo+ICsKPiArCWxpc3RfYWRkX3RhaWwoJmNoaXAtPm5vZGUsICZuZmMt
PmNoaXBzKTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBya19uZmNf
bmFuZF9jaGlwc19pbml0KHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IHJrX25mYyAqbmZjKQo+
ICt7Cj4gKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5wID0gZGV2LT5vZl9ub2RlOwo+ICsJc3RydWN0
IGRldmljZV9ub2RlICpuYW5kX25wOwo+ICsJaW50IHJldCA9IC1FSU5WQUw7Cj4gKwlpbnQgdG1w
Owo+ICsKPiArCWZvcl9lYWNoX2NoaWxkX29mX25vZGUobnAsIG5hbmRfbnApIHsKPiArCQl0bXAg
PSBya19uZmNfbmFuZF9jaGlwX2luaXQoZGV2LCBuZmMsIG5hbmRfbnApOwo+ICsJCWlmICh0bXAp
IHsKPiArCQkJb2Zfbm9kZV9wdXQobmFuZF9ucCk7Cj4gKwkJCXJldHVybiByZXQ7Cj4gKwkJfQo+
ICsJCS8qIEF0IGxlYXN0IG9uZSBuYW5kIGNoaXAgaXMgaW5pdGlhbGl6ZWQgKi8KPiArCQlyZXQg
PSAwOwo+ICsJfQo+ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIGNvbnN0IHN0cnVj
dCBvZl9kZXZpY2VfaWQgcmtfbmZjX2lkX3RhYmxlW10gPSB7Cj4gKwl7LmNvbXBhdGlibGUgPSAi
cm9ja2NoaXAsbmZjIn0sCj4gKwl7fQo+ICt9Owo+ICtNT0RVTEVfREVWSUNFX1RBQkxFKG9mLCBy
a19uZmNfaWRfdGFibGUpOwo+ICsKPiArc3RhdGljIGludCBya19uZmNfcHJvYmUoc3RydWN0IHBs
YXRmb3JtX2RldmljZSAqcGRldikKPiArewo+ICsJc3RydWN0IGRldmljZSAqZGV2ID0gJnBkZXYt
PmRldjsKPiArCXN0cnVjdCBya19uZmMgKm5mYzsKPiArCXN0cnVjdCByZXNvdXJjZSAqcmVzOwo+
ICsJaW50IHJldCwgaXJxOwo+ICsKPiArCW5mYyA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigq
bmZjKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoIW5mYykKPiArCQlyZXR1cm4gLUVOT01FTTsKPiAr
Cj4gKwluYW5kX2NvbnRyb2xsZXJfaW5pdCgmbmZjLT5jb250cm9sbGVyKTsKPiArCUlOSVRfTElT
VF9IRUFEKCZuZmMtPmNoaXBzKTsKPiArCW5mYy0+Y29udHJvbGxlci5vcHMgPSAmcmtfbmZjX2Nv
bnRyb2xsZXJfb3BzOwo+ICsJbmZjLT5kZXYgPSBkZXY7Cj4gKwo+ICsJcmVzID0gcGxhdGZvcm1f
Z2V0X3Jlc291cmNlKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAwKTsKPiArCW5mYy0+cmVncyA9IGRl
dm1faW9yZW1hcF9yZXNvdXJjZShkZXYsIHJlcyk7Cj4gKwlpZiAoSVNfRVJSKG5mYy0+cmVncykp
IHsKPiArCQlyZXQgPSBQVFJfRVJSKG5mYy0+cmVncyk7Cj4gKwkJZ290byByZWxlYXNlX25mYzsK
PiArCX0KPiArCW5mYy0+Y2xrLm5mY19jbGsgPSBkZXZtX2Nsa19nZXQoZGV2LCAiY2xrX25mYyIp
Owo+ICsJaWYgKElTX0VSUihuZmMtPmNsay5uZmNfY2xrKSkgewo+ICsJCWRldl9lcnIoZGV2LCAi
bm8gY2xrXG4iKTsKPiArCQlyZXQgPSBQVFJfRVJSKG5mYy0+Y2xrLm5mY19jbGspOwo+ICsJCWdv
dG8gcmVsZWFzZV9uZmM7Cj4gKwl9Cj4gKwluZmMtPmNsay5haGJfY2xrID0gZGV2bV9jbGtfZ2V0
KGRldiwgImNsa19haGIiKTsKPiArCWlmIChJU19FUlIobmZjLT5jbGsuYWhiX2NsaykpIHsKPiAr
CQlkZXZfZXJyKGRldiwgIm5vIHBhZCBjbGtcbiIpOwo+ICsJCXJldCA9IFBUUl9FUlIobmZjLT5j
bGsuYWhiX2Nsayk7Cj4gKwkJZ290byByZWxlYXNlX25mYzsKPiArCX0KPiArCWlmIChvZl9wcm9w
ZXJ0eV9yZWFkX3UzMihkZXYtPm9mX25vZGUsICJjbG9jay1yYXRlcyIsCj4gKwkgICAgJm5mYy0+
Y2xrLm5mY19yYXRlKSkKPiArCQluZmMtPmNsay5uZmNfcmF0ZSA9IFJLX0RFRkFVTFRfQ0xPQ0tf
UkFURTsKPiArCWNsa19zZXRfcmF0ZShuZmMtPmNsay5uZmNfY2xrLCBuZmMtPmNsay5uZmNfcmF0
ZSk7Cj4gKwo+ICsJcmV0ID0gcmtfbmZjX2VuYWJsZV9jbGsoZGV2LCAmbmZjLT5jbGspOwo+ICsJ
aWYgKHJldCkKPiArCQlnb3RvIHJlbGVhc2VfbmZjOwo+ICsKPiArCWlycSA9IHBsYXRmb3JtX2dl
dF9pcnEocGRldiwgMCk7Cj4gKwlpZiAoaXJxIDwgMCkgewo+ICsJCWRldl9lcnIoZGV2LCAibm8g
bmZjIGlycSByZXNvdXJjZVxuIik7Cj4gKwkJcmV0ID0gLUVJTlZBTDsKPiArCQlnb3RvIGNsa19k
aXNhYmxlOwo+ICsJfQo+ICsKPiArCWlmIChuZmMtPm5mY192ZXJzaW9uID09IDYpCj4gKwkJbmZj
X3dyaXRlbChuZmMsIDAsIE5GQ19JTlRFTl9WNik7Cj4gKwllbHNlCj4gKwkJbmZjX3dyaXRlbChu
ZmMsIDAsIE5GQ19JTlRFTl9WOSk7Cj4gKwlyZXQgPSBkZXZtX3JlcXVlc3RfaXJxKGRldiwgaXJx
LCBya19uZmNfaXJxLCAweDAsICJyay1uYW5kIiwgbmZjKTsKPiArCWlmIChyZXQpIHsKPiArCQlk
ZXZfZXJyKGRldiwgImZhaWxlZCB0byByZXF1ZXN0IG5mYyBpcnFcbiIpOwo+ICsJCWdvdG8gY2xr
X2Rpc2FibGU7Cj4gKwl9Cj4gKwo+ICsJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgbmZjKTsK
PiArCj4gKwlyZXQgPSBya19uZmNfbmFuZF9jaGlwc19pbml0KGRldiwgbmZjKTsKPiArCWlmIChy
ZXQpIHsKPiArCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBpbml0IG5hbmQgY2hpcHNcbiIpOwo+
ICsJCWdvdG8gY2xrX2Rpc2FibGU7Cj4gKwl9Cj4gKwlyZXR1cm4gMDsKPiArCj4gK2Nsa19kaXNh
YmxlOgo+ICsJcmtfbmZjX2Rpc2FibGVfY2xrKCZuZmMtPmNsayk7Cj4gK3JlbGVhc2VfbmZjOgo+
ICsJcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIGludCBya19uZmNfcmVtb3ZlKHN0cnVj
dCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCj4gK3sKPiArCXN0cnVjdCBya19uZmMgKm5mYyA9IHBs
YXRmb3JtX2dldF9kcnZkYXRhKHBkZXYpOwo+ICsJc3RydWN0IHJrX25mY19uYW5kX2NoaXAgKmNo
aXA7Cj4gKwo+ICsJd2hpbGUgKCFsaXN0X2VtcHR5KCZuZmMtPmNoaXBzKSkgewo+ICsJCWNoaXAg
PSBsaXN0X2ZpcnN0X2VudHJ5KCZuZmMtPmNoaXBzLCBzdHJ1Y3QgcmtfbmZjX25hbmRfY2hpcCwK
PiArCQkJCQlub2RlKTsKPiArCQluYW5kX3JlbGVhc2UoJmNoaXAtPm5hbmQpOwo+ICsJCWxpc3Rf
ZGVsKCZjaGlwLT5ub2RlKTsKPiArCX0KPiArCj4gKwlya19uZmNfZGlzYWJsZV9jbGsoJm5mYy0+
Y2xrKTsKPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArI2lmZGVmIENPTkZJR19QTV9TTEVF
UAo+ICtzdGF0aWMgaW50IHJrX25mY19zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikKPiArewo+
ICsJc3RydWN0IHJrX25mYyAqbmZjID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKwo+ICsJcmtf
bmZjX2Rpc2FibGVfY2xrKCZuZmMtPmNsayk7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgcmtfbmZjX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sKPiArCXN0
cnVjdCBya19uZmMgKm5mYyA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ICsJc3RydWN0IHJrX25m
Y19uYW5kX2NoaXAgKmNoaXA7Cj4gKwlzdHJ1Y3QgbmFuZF9jaGlwICpuYW5kOwo+ICsJaW50IHJl
dDsKPiArCXUzMiBpOwo+ICsKPiArCXVkZWxheSgyMDApOwo+ICsKPiArCXJldCA9IHJrX25mY19l
bmFibGVfY2xrKGRldiwgJm5mYy0+Y2xrKTsKPiArCWlmIChyZXQpCj4gKwkJcmV0dXJuIHJldDsK
PiArCj4gKwkvKiByZXNldCBOQU5EIGNoaXAgaWYgVkNDIHdhcyBwb3dlcmVkIG9mZiAqLwo+ICsJ
bGlzdF9mb3JfZWFjaF9lbnRyeShjaGlwLCAmbmZjLT5jaGlwcywgbm9kZSkgewo+ICsJCW5hbmQg
PSAmY2hpcC0+bmFuZDsKPiArCQlmb3IgKGkgPSAwOyBpIDwgY2hpcC0+bnNlbHM7IGkrKykKPiAr
CQkJbmFuZF9yZXNldChuYW5kLCBpKTsKPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsK
PiArc3RhdGljIFNJTVBMRV9ERVZfUE1fT1BTKHJrX25mY19wbV9vcHMsIHJrX25mY19zdXNwZW5k
LCBya19uZmNfcmVzdW1lKTsKCkkgdGhpbmsgeW91IGNhbiBkZWZpbmUgYSBkZXZfcG1fb3BzIHN0
dWN0dXJlIHRvIGNvbnRhaW4gYQpTRVRfU1lTVEVNX1NMRUVQX1BNX09QUygqc3VzcGVuZCwgKnJl
c3VtZSkgYW5kIHRoaXMgd2F5IHlvdSBjYW4KZW50aXJlbHkgZ2V0IHJpZCBvZiB0aGUgI2lmZGVm
IGNvbmRpdGlvbmFscy4KCj4gKyNlbmRpZgo+ICsKPiArc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9k
cml2ZXIgcmtfbmZjX2RyaXZlciA9IHsKPiArCS5wcm9iZSAgPSBya19uZmNfcHJvYmUsCj4gKwku
cmVtb3ZlID0gcmtfbmZjX3JlbW92ZSwKPiArCS5kcml2ZXIgPSB7Cj4gKwkJLm5hbWUgID0gVEhJ
U19OQU1FLAo+ICsJCS5vZl9tYXRjaF90YWJsZSA9IHJrX25mY19pZF90YWJsZSwKPiArI2lmZGVm
IENPTkZJR19QTV9TTEVFUAo+ICsJCS5wbSA9ICZya19uZmNfcG1fb3BzLAo+ICsjZW5kaWYKPiAr
CX0sCj4gK307Cj4gKwo+ICttb2R1bGVfcGxhdGZvcm1fZHJpdmVyKHJrX25mY19kcml2ZXIpOwo+
ICsKPiArTU9EVUxFX0xJQ0VOU0UoIkR1YWwgTUlUL0dQTCIpOwo+ICtNT0RVTEVfQVVUSE9SKCJZ
aWZlbmcgWmhhbyA8eWlmZW5nLnpoYW9Acm9jay1jaGlwcy5jb20+Iik7Cj4gK01PRFVMRV9ERVND
UklQVElPTigiUm9ja2NoaXAgTmFuZCBGbGFzaCBDb250cm9sbGVyIERyaXZlciIpOwo+ICtNT0RV
TEVfQUxJQVMoInBsYXRmb3JtOnJvY2tjaGlwX25hbmQiKTsKCgpUaGFua3MsCk1pcXXDqGwKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkxpbnV4LXJvY2tj
aGlwIG1haWxpbmcgbGlzdApMaW51eC1yb2NrY2hpcEBsaXN0cy5pbmZyYWRlYWQub3JnCmh0dHA6
Ly9saXN0cy5pbmZyYWRlYWQub3JnL21haWxtYW4vbGlzdGluZm8vbGludXgtcm9ja2NoaXAK
